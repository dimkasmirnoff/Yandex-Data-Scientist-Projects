{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Исследование надёжности заёмщиков"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Заказчик — кредитный отдел банка. Нужно разобраться, влияет ли семейное положение и количество детей клиента на факт погашения кредита в срок. Входные данные от банка — статистика о платёжеспособности клиентов.\n",
    "\n",
    "Результаты исследования будут учтены при построении модели **кредитного скоринга** — специальной системы, которая оценивает способность потенциального заёмщика вернуть кредит банку."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Задачи\n",
    "### Шаг 1. [Откройте таблицу и изучите общую информацию о данных](#step1)\n",
    "\n",
    "###  Шаг 2.  [Предобработка данных](#step2)\n",
    "\n",
    "- определите и заполните пропущенные значения:\n",
    "   - опишите, какие пропущенные значения вы обнаружили;\n",
    "   - приведите возможные причины появления пропусков в данных;\n",
    "   - объясните, по какому принципу заполнены пропуски;\n",
    "- замените вещественный тип данных на целочисленный:\n",
    "   - поясните, как выбирали метод для изменения типа данных;\n",
    "- удалите дубликаты:\n",
    "   - поясните, как выбирали метод для поиска и удаления дубликатов в данных;\n",
    "   - приведите возможные причины появления дубликатов;\n",
    "- выделите леммы в значениях столбца с целями получения кредита:\n",
    "   - опишите, как вы проводили лемматизацию целей кредита;\n",
    "- категоризируйте данные:\n",
    "   - перечислите, какие «словари» вы выделили для этого набора данных, и объясните, почему.\n",
    "\n",
    "###  Шаг 3. [Ответьте на вопросы](#step3)\n",
    "\n",
    "Определите и заполните пропущенные значения:\n",
    " - Есть ли зависимость между наличием детей и возвратом кредита в срок?\n",
    " - Есть ли зависимость между семейным положением и возвратом кредита в срок?\n",
    " - Есть ли зависимость между уровнем дохода и возвратом кредита в срок?\n",
    " - Как разные цели кредита влияют на его возврат в срок?"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Шаг 1. Откройте файл с данными и изучите общую информацию.<a id=\"step1\"></a>"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "from pymystem3 import Mystem"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 21525 entries, 0 to 21524\n",
      "Data columns (total 12 columns):\n",
      "children            21525 non-null int64\n",
      "days_employed       19351 non-null float64\n",
      "dob_years           21525 non-null int64\n",
      "education           21525 non-null object\n",
      "education_id        21525 non-null int64\n",
      "family_status       21525 non-null object\n",
      "family_status_id    21525 non-null int64\n",
      "gender              21525 non-null object\n",
      "income_type         21525 non-null object\n",
      "debt                21525 non-null int64\n",
      "total_income        19351 non-null float64\n",
      "purpose             21525 non-null object\n",
      "dtypes: float64(2), int64(5), object(5)\n",
      "memory usage: 2.0+ MB\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>children</th>\n",
       "      <th>days_employed</th>\n",
       "      <th>dob_years</th>\n",
       "      <th>education</th>\n",
       "      <th>education_id</th>\n",
       "      <th>family_status</th>\n",
       "      <th>family_status_id</th>\n",
       "      <th>gender</th>\n",
       "      <th>income_type</th>\n",
       "      <th>debt</th>\n",
       "      <th>total_income</th>\n",
       "      <th>purpose</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>-8437.673028</td>\n",
       "      <td>42</td>\n",
       "      <td>высшее</td>\n",
       "      <td>0</td>\n",
       "      <td>женат / замужем</td>\n",
       "      <td>0</td>\n",
       "      <td>F</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>0</td>\n",
       "      <td>253875.639453</td>\n",
       "      <td>покупка жилья</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>-4024.803754</td>\n",
       "      <td>36</td>\n",
       "      <td>среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>женат / замужем</td>\n",
       "      <td>0</td>\n",
       "      <td>F</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>0</td>\n",
       "      <td>112080.014102</td>\n",
       "      <td>приобретение автомобиля</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>-5623.422610</td>\n",
       "      <td>33</td>\n",
       "      <td>Среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>женат / замужем</td>\n",
       "      <td>0</td>\n",
       "      <td>M</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>0</td>\n",
       "      <td>145885.952297</td>\n",
       "      <td>покупка жилья</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>-4124.747207</td>\n",
       "      <td>32</td>\n",
       "      <td>среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>женат / замужем</td>\n",
       "      <td>0</td>\n",
       "      <td>M</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>0</td>\n",
       "      <td>267628.550329</td>\n",
       "      <td>дополнительное образование</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>340266.072047</td>\n",
       "      <td>53</td>\n",
       "      <td>среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>гражданский брак</td>\n",
       "      <td>1</td>\n",
       "      <td>F</td>\n",
       "      <td>пенсионер</td>\n",
       "      <td>0</td>\n",
       "      <td>158616.077870</td>\n",
       "      <td>сыграть свадьбу</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>-926.185831</td>\n",
       "      <td>27</td>\n",
       "      <td>высшее</td>\n",
       "      <td>0</td>\n",
       "      <td>гражданский брак</td>\n",
       "      <td>1</td>\n",
       "      <td>M</td>\n",
       "      <td>компаньон</td>\n",
       "      <td>0</td>\n",
       "      <td>255763.565419</td>\n",
       "      <td>покупка жилья</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>-2879.202052</td>\n",
       "      <td>43</td>\n",
       "      <td>высшее</td>\n",
       "      <td>0</td>\n",
       "      <td>женат / замужем</td>\n",
       "      <td>0</td>\n",
       "      <td>F</td>\n",
       "      <td>компаньон</td>\n",
       "      <td>0</td>\n",
       "      <td>240525.971920</td>\n",
       "      <td>операции с жильем</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>7</td>\n",
       "      <td>0</td>\n",
       "      <td>-152.779569</td>\n",
       "      <td>50</td>\n",
       "      <td>СРЕДНЕЕ</td>\n",
       "      <td>1</td>\n",
       "      <td>женат / замужем</td>\n",
       "      <td>0</td>\n",
       "      <td>M</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>0</td>\n",
       "      <td>135823.934197</td>\n",
       "      <td>образование</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>8</td>\n",
       "      <td>2</td>\n",
       "      <td>-6929.865299</td>\n",
       "      <td>35</td>\n",
       "      <td>ВЫСШЕЕ</td>\n",
       "      <td>0</td>\n",
       "      <td>гражданский брак</td>\n",
       "      <td>1</td>\n",
       "      <td>F</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>0</td>\n",
       "      <td>95856.832424</td>\n",
       "      <td>на проведение свадьбы</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>9</td>\n",
       "      <td>0</td>\n",
       "      <td>-2188.756445</td>\n",
       "      <td>41</td>\n",
       "      <td>среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>женат / замужем</td>\n",
       "      <td>0</td>\n",
       "      <td>M</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>0</td>\n",
       "      <td>144425.938277</td>\n",
       "      <td>покупка жилья для семьи</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   children  days_employed  dob_years education  education_id  \\\n",
       "0         1   -8437.673028         42    высшее             0   \n",
       "1         1   -4024.803754         36   среднее             1   \n",
       "2         0   -5623.422610         33   Среднее             1   \n",
       "3         3   -4124.747207         32   среднее             1   \n",
       "4         0  340266.072047         53   среднее             1   \n",
       "5         0    -926.185831         27    высшее             0   \n",
       "6         0   -2879.202052         43    высшее             0   \n",
       "7         0    -152.779569         50   СРЕДНЕЕ             1   \n",
       "8         2   -6929.865299         35    ВЫСШЕЕ             0   \n",
       "9         0   -2188.756445         41   среднее             1   \n",
       "\n",
       "      family_status  family_status_id gender income_type  debt   total_income  \\\n",
       "0   женат / замужем                 0      F   сотрудник     0  253875.639453   \n",
       "1   женат / замужем                 0      F   сотрудник     0  112080.014102   \n",
       "2   женат / замужем                 0      M   сотрудник     0  145885.952297   \n",
       "3   женат / замужем                 0      M   сотрудник     0  267628.550329   \n",
       "4  гражданский брак                 1      F   пенсионер     0  158616.077870   \n",
       "5  гражданский брак                 1      M   компаньон     0  255763.565419   \n",
       "6   женат / замужем                 0      F   компаньон     0  240525.971920   \n",
       "7   женат / замужем                 0      M   сотрудник     0  135823.934197   \n",
       "8  гражданский брак                 1      F   сотрудник     0   95856.832424   \n",
       "9   женат / замужем                 0      M   сотрудник     0  144425.938277   \n",
       "\n",
       "                      purpose  \n",
       "0               покупка жилья  \n",
       "1     приобретение автомобиля  \n",
       "2               покупка жилья  \n",
       "3  дополнительное образование  \n",
       "4             сыграть свадьбу  \n",
       "5               покупка жилья  \n",
       "6           операции с жильем  \n",
       "7                 образование  \n",
       "8       на проведение свадьбы  \n",
       "9     покупка жилья для семьи  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "['children', 'days_employed', 'dob_years', 'education', 'education_id', 'family_status', 'family_status_id', 'gender', 'income_type', 'debt', 'total_income', 'purpose']\n",
      "Уникальные значения в столбце: children  -  [ 1  0  3  2 -1  4 20  5]\n",
      "Уникальные значения в столбце: days_employed  -  [-8437.67302776 -4024.80375385 -5623.42261023 ... -2113.3468877\n",
      " -3112.4817052  -1984.50758853]\n",
      "Уникальные значения в столбце: dob_years  -  [42 36 33 32 53 27 43 50 35 41 40 65 54 56 26 48 24 21 57 67 28 63 62 47\n",
      " 34 68 25 31 30 20 49 37 45 61 64 44 52 46 23 38 39 51  0 59 29 60 55 58\n",
      " 71 22 73 66 69 19 72 70 74 75]\n",
      "Уникальные значения в столбце: education  -  ['высшее' 'среднее' 'Среднее' 'СРЕДНЕЕ' 'ВЫСШЕЕ' 'неоконченное высшее'\n",
      " 'начальное' 'Высшее' 'НЕОКОНЧЕННОЕ ВЫСШЕЕ' 'Неоконченное высшее'\n",
      " 'НАЧАЛЬНОЕ' 'Начальное' 'Ученая степень' 'УЧЕНАЯ СТЕПЕНЬ'\n",
      " 'ученая степень']\n",
      "Уникальные значения в столбце: education_id  -  [0 1 2 3 4]\n",
      "Уникальные значения в столбце: family_status  -  ['женат / замужем' 'гражданский брак' 'вдовец / вдова' 'в разводе'\n",
      " 'Не женат / не замужем']\n",
      "Уникальные значения в столбце: family_status_id  -  [0 1 2 3 4]\n",
      "Уникальные значения в столбце: gender  -  ['F' 'M' 'XNA']\n",
      "Уникальные значения в столбце: income_type  -  ['сотрудник' 'пенсионер' 'компаньон' 'госслужащий' 'безработный'\n",
      " 'предприниматель' 'студент' 'в декрете']\n",
      "Уникальные значения в столбце: debt  -  [0 1]\n",
      "Уникальные значения в столбце: total_income  -  [253875.6394526  112080.01410244 145885.95229686 ...  89672.56115303\n",
      " 244093.05050043  82047.41889948]\n",
      "Уникальные значения в столбце: purpose  -  ['покупка жилья' 'приобретение автомобиля' 'дополнительное образование'\n",
      " 'сыграть свадьбу' 'операции с жильем' 'образование'\n",
      " 'на проведение свадьбы' 'покупка жилья для семьи' 'покупка недвижимости'\n",
      " 'покупка коммерческой недвижимости' 'покупка жилой недвижимости'\n",
      " 'строительство собственной недвижимости' 'недвижимость'\n",
      " 'строительство недвижимости' 'на покупку подержанного автомобиля'\n",
      " 'на покупку своего автомобиля' 'операции с коммерческой недвижимостью'\n",
      " 'строительство жилой недвижимости' 'жилье'\n",
      " 'операции со своей недвижимостью' 'автомобили' 'заняться образованием'\n",
      " 'сделка с подержанным автомобилем' 'получение образования' 'автомобиль'\n",
      " 'свадьба' 'получение дополнительного образования' 'покупка своего жилья'\n",
      " 'операции с недвижимостью' 'получение высшего образования'\n",
      " 'свой автомобиль' 'сделка с автомобилем' 'профильное образование'\n",
      " 'высшее образование' 'покупка жилья для сдачи' 'на покупку автомобиля'\n",
      " 'ремонт жилью' 'заняться высшим образованием']\n",
      "Количество дубликатов: 54\n"
     ]
    }
   ],
   "source": [
    "clients = pd.read_csv('/datasets/data.csv')\n",
    "clients.info()\n",
    "\n",
    "display(clients.head(10))\n",
    "columns_names = clients.columns.tolist()\n",
    "print(columns_names)\n",
    "for column_name in columns_names:\n",
    "    print('Уникальные значения в столбце:', column_name,' - ',clients[column_name].unique())\n",
    "print('Количество дубликатов:', clients.duplicated().sum())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>children</th>\n",
       "      <th>days_employed</th>\n",
       "      <th>dob_years</th>\n",
       "      <th>education_id</th>\n",
       "      <th>family_status_id</th>\n",
       "      <th>debt</th>\n",
       "      <th>total_income</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>count</td>\n",
       "      <td>21525.000000</td>\n",
       "      <td>19351.000000</td>\n",
       "      <td>21525.000000</td>\n",
       "      <td>21525.000000</td>\n",
       "      <td>21525.000000</td>\n",
       "      <td>21525.000000</td>\n",
       "      <td>1.935100e+04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>mean</td>\n",
       "      <td>0.538908</td>\n",
       "      <td>63046.497661</td>\n",
       "      <td>43.293380</td>\n",
       "      <td>0.817236</td>\n",
       "      <td>0.972544</td>\n",
       "      <td>0.080883</td>\n",
       "      <td>1.674223e+05</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>std</td>\n",
       "      <td>1.381587</td>\n",
       "      <td>140827.311974</td>\n",
       "      <td>12.574584</td>\n",
       "      <td>0.548138</td>\n",
       "      <td>1.420324</td>\n",
       "      <td>0.272661</td>\n",
       "      <td>1.029716e+05</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>min</td>\n",
       "      <td>-1.000000</td>\n",
       "      <td>-18388.949901</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>2.066726e+04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>25%</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>-2747.423625</td>\n",
       "      <td>33.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.030532e+05</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>50%</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>-1203.369529</td>\n",
       "      <td>42.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.450179e+05</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>75%</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>-291.095954</td>\n",
       "      <td>53.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>2.034351e+05</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>max</td>\n",
       "      <td>20.000000</td>\n",
       "      <td>401755.400475</td>\n",
       "      <td>75.000000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>2.265604e+06</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "           children  days_employed     dob_years  education_id  \\\n",
       "count  21525.000000   19351.000000  21525.000000  21525.000000   \n",
       "mean       0.538908   63046.497661     43.293380      0.817236   \n",
       "std        1.381587  140827.311974     12.574584      0.548138   \n",
       "min       -1.000000  -18388.949901      0.000000      0.000000   \n",
       "25%        0.000000   -2747.423625     33.000000      1.000000   \n",
       "50%        0.000000   -1203.369529     42.000000      1.000000   \n",
       "75%        1.000000    -291.095954     53.000000      1.000000   \n",
       "max       20.000000  401755.400475     75.000000      4.000000   \n",
       "\n",
       "       family_status_id          debt  total_income  \n",
       "count      21525.000000  21525.000000  1.935100e+04  \n",
       "mean           0.972544      0.080883  1.674223e+05  \n",
       "std            1.420324      0.272661  1.029716e+05  \n",
       "min            0.000000      0.000000  2.066726e+04  \n",
       "25%            0.000000      0.000000  1.030532e+05  \n",
       "50%            0.000000      0.000000  1.450179e+05  \n",
       "75%            1.000000      0.000000  2.034351e+05  \n",
       "max            4.000000      1.000000  2.265604e+06  "
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "clients.describe()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Вывод"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Первоначальная таблица состоит из 21525 строк и 12 столбцов. Краткая информация о тех данных, которые были замечены во время ознакомления с информацией:\n",
    " - В двух столбцах (days_employed, total_income) имеются пропуски.\n",
    " - В первом столбце (children) замечены следующие значения, вызвавшие интерес: отрицательные значения (-1) и слишком большое количество детей - 20. Скорей всего это просто опечатка, и в первом случае необходимо заменить значение на (1), а во втором - убрать лишний 0. \n",
    " - Во втором столбце (days_employed) имеется опечатка. Данные содержат отрицательные значения, что не совсем корректно. \n",
    " - В третьем столбце (dob_years) у некоторых строк значение равняется 0, что также некорректно. \n",
    " - В четвертом столбце (education) есть значения в верхнем и нижнем регистре. Их стоит все привести в единый формат - нижний регистр.\n",
    " - В столбце (gender) имеется артфекат. Одна строка имеет значение XNA.\n",
    " - В столбце (purpose) имеются дублирующиеся значения по своему смыслу, но разные по заполнению. Например - приобретение автомобиля, на покупку своего автомобиля, автомобили, автомобиль. Такие группы стоит объединить в один кластер.\n",
    " - Количество дубликатов - 54."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Шаг 2. Предобработка данных<a id=\"step2\"></a>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Обработка пропусков"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 21424 entries, 0 to 21423\n",
      "Data columns (total 12 columns):\n",
      "children            21424 non-null int64\n",
      "days_employed       19260 non-null float64\n",
      "dob_years           21424 non-null int64\n",
      "education           21424 non-null object\n",
      "education_id        21424 non-null int64\n",
      "family_status       21424 non-null object\n",
      "family_status_id    21424 non-null int64\n",
      "gender              21424 non-null object\n",
      "income_type         21424 non-null object\n",
      "debt                21424 non-null int64\n",
      "total_income        19260 non-null float64\n",
      "purpose             21424 non-null object\n",
      "dtypes: float64(2), int64(5), object(5)\n",
      "memory usage: 2.0+ MB\n"
     ]
    }
   ],
   "source": [
    "clients['days_employed'] = clients['days_employed'].abs()\n",
    "clients.loc[clients['income_type'] == 'пенсионер', 'days_employed'] = clients['days_employed']/24\n",
    "clients['children'] = clients['children'].abs()\n",
    "clients['children'] = clients['children'].replace(20, 2)\n",
    "clients = clients.loc[clients['dob_years'] != 0].reset_index(drop = True)\n",
    "\n",
    "clients.info()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Вывод"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    " - Заменены отрицательные значения в столбцах days_employed и children.\n",
    " - Также было выявлено, что в столбце days_employed неверно заданы значения для пенсонеров (столбец income_type)\n",
    " - В столбце children значения 20 заменены на 2.\n",
    " - В столбце dob_years количество строк со значеним \"0\" составляет менее 1%. Заменять значения на средние в данном случае будет некорректно, поскольку имеются значения income_type = пенсионер, что приведет к несостыковке. Можно конечно попробовать категоризировать их.  Но на данной итерации я попробую их просто удалить.\n",
    " \n",
    " Обработка пустых значений произойдет на следующем этапе.\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Замена типа данных"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "4678.248495370752\n",
      "145011.70929552132\n",
      "education\n",
      "высшее                 207327.677426\n",
      "начальное              132155.513626\n",
      "неоконченное высшее    181502.449011\n",
      "среднее                153752.210093\n",
      "ученая степень         174750.155792\n",
      "Name: total_income, dtype: float64\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>children</th>\n",
       "      <th>days_employed</th>\n",
       "      <th>dob_years</th>\n",
       "      <th>education</th>\n",
       "      <th>education_id</th>\n",
       "      <th>family_status</th>\n",
       "      <th>family_status_id</th>\n",
       "      <th>gender</th>\n",
       "      <th>income_type</th>\n",
       "      <th>debt</th>\n",
       "      <th>total_income</th>\n",
       "      <th>purpose</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>8437</td>\n",
       "      <td>42</td>\n",
       "      <td>высшее</td>\n",
       "      <td>0</td>\n",
       "      <td>женат / замужем</td>\n",
       "      <td>0</td>\n",
       "      <td>F</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>0</td>\n",
       "      <td>253875</td>\n",
       "      <td>покупка жилья</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>4024</td>\n",
       "      <td>36</td>\n",
       "      <td>среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>женат / замужем</td>\n",
       "      <td>0</td>\n",
       "      <td>F</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>0</td>\n",
       "      <td>112080</td>\n",
       "      <td>приобретение автомобиля</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>5623</td>\n",
       "      <td>33</td>\n",
       "      <td>среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>женат / замужем</td>\n",
       "      <td>0</td>\n",
       "      <td>M</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>0</td>\n",
       "      <td>145885</td>\n",
       "      <td>покупка жилья</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>4124</td>\n",
       "      <td>32</td>\n",
       "      <td>среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>женат / замужем</td>\n",
       "      <td>0</td>\n",
       "      <td>M</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>0</td>\n",
       "      <td>267628</td>\n",
       "      <td>дополнительное образование</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>14177</td>\n",
       "      <td>53</td>\n",
       "      <td>среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>гражданский брак</td>\n",
       "      <td>1</td>\n",
       "      <td>F</td>\n",
       "      <td>пенсионер</td>\n",
       "      <td>0</td>\n",
       "      <td>158616</td>\n",
       "      <td>сыграть свадьбу</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>926</td>\n",
       "      <td>27</td>\n",
       "      <td>высшее</td>\n",
       "      <td>0</td>\n",
       "      <td>гражданский брак</td>\n",
       "      <td>1</td>\n",
       "      <td>M</td>\n",
       "      <td>компаньон</td>\n",
       "      <td>0</td>\n",
       "      <td>255763</td>\n",
       "      <td>покупка жилья</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>2879</td>\n",
       "      <td>43</td>\n",
       "      <td>высшее</td>\n",
       "      <td>0</td>\n",
       "      <td>женат / замужем</td>\n",
       "      <td>0</td>\n",
       "      <td>F</td>\n",
       "      <td>компаньон</td>\n",
       "      <td>0</td>\n",
       "      <td>240525</td>\n",
       "      <td>операции с жильем</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>7</td>\n",
       "      <td>0</td>\n",
       "      <td>152</td>\n",
       "      <td>50</td>\n",
       "      <td>среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>женат / замужем</td>\n",
       "      <td>0</td>\n",
       "      <td>M</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>0</td>\n",
       "      <td>135823</td>\n",
       "      <td>образование</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>8</td>\n",
       "      <td>2</td>\n",
       "      <td>6929</td>\n",
       "      <td>35</td>\n",
       "      <td>высшее</td>\n",
       "      <td>0</td>\n",
       "      <td>гражданский брак</td>\n",
       "      <td>1</td>\n",
       "      <td>F</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>0</td>\n",
       "      <td>95856</td>\n",
       "      <td>на проведение свадьбы</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>9</td>\n",
       "      <td>0</td>\n",
       "      <td>2188</td>\n",
       "      <td>41</td>\n",
       "      <td>среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>женат / замужем</td>\n",
       "      <td>0</td>\n",
       "      <td>M</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>0</td>\n",
       "      <td>144425</td>\n",
       "      <td>покупка жилья для семьи</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   children  days_employed  dob_years education  education_id  \\\n",
       "0         1           8437         42    высшее             0   \n",
       "1         1           4024         36   среднее             1   \n",
       "2         0           5623         33   среднее             1   \n",
       "3         3           4124         32   среднее             1   \n",
       "4         0          14177         53   среднее             1   \n",
       "5         0            926         27    высшее             0   \n",
       "6         0           2879         43    высшее             0   \n",
       "7         0            152         50   среднее             1   \n",
       "8         2           6929         35    высшее             0   \n",
       "9         0           2188         41   среднее             1   \n",
       "\n",
       "      family_status  family_status_id gender income_type  debt  total_income  \\\n",
       "0   женат / замужем                 0      F   сотрудник     0        253875   \n",
       "1   женат / замужем                 0      F   сотрудник     0        112080   \n",
       "2   женат / замужем                 0      M   сотрудник     0        145885   \n",
       "3   женат / замужем                 0      M   сотрудник     0        267628   \n",
       "4  гражданский брак                 1      F   пенсионер     0        158616   \n",
       "5  гражданский брак                 1      M   компаньон     0        255763   \n",
       "6   женат / замужем                 0      F   компаньон     0        240525   \n",
       "7   женат / замужем                 0      M   сотрудник     0        135823   \n",
       "8  гражданский брак                 1      F   сотрудник     0         95856   \n",
       "9   женат / замужем                 0      M   сотрудник     0        144425   \n",
       "\n",
       "                      purpose  \n",
       "0               покупка жилья  \n",
       "1     приобретение автомобиля  \n",
       "2               покупка жилья  \n",
       "3  дополнительное образование  \n",
       "4             сыграть свадьбу  \n",
       "5               покупка жилья  \n",
       "6           операции с жильем  \n",
       "7                 образование  \n",
       "8       на проведение свадьбы  \n",
       "9     покупка жилья для семьи  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "153752.0\n"
     ]
    }
   ],
   "source": [
    "clients['education'] = clients['education'].str.lower()\n",
    "days_mean = clients['days_employed'].mean()\n",
    "print(days_mean)\n",
    "total_income_median = clients['total_income'].median()\n",
    "print(total_income_median)\n",
    "education_total_income = clients.groupby('education')['total_income'].mean()\n",
    "print(education_total_income)\n",
    "\n",
    "clients.loc[(clients['education'] == 'высшее',['total_income'])] = clients.loc[(clients['education'] == 'высшее',['total_income'])].fillna(education_total_income[0])\n",
    "clients.loc[(clients['education'] == 'среднее',['total_income'])] = clients.loc[(clients['education'] == 'среднее',['total_income'])].fillna(education_total_income[3])\n",
    "clients.loc[(clients['education'] == 'неоконченное высшее',['total_income'])] = clients.loc[(clients['education'] == 'неоконченное высшее',['total_income'])].fillna(education_total_income[2])\n",
    "clients.loc[(clients['education'] == 'начальное',['total_income'])] = clients.loc[(clients['education'] == 'начальное',['total_income'])].fillna(education_total_income[1])\n",
    "clients.loc[(clients['education'] == 'ученая степень',['total_income'])] = clients.loc[(clients['education'] == 'ученая степень',['total_income'])].fillna(education_total_income[4])\n",
    "\n",
    "clients['days_employed'] = clients['days_employed'].fillna(days_mean).astype(int)\n",
    "clients['total_income'] = clients['total_income'].fillna(total_income_median).astype(int)\n",
    "display(clients.head(10))\n",
    "\n",
    "total_income_median = clients['total_income'].median()\n",
    "print(total_income_median)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Вывод"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Была вычислены средняя арифметическая в столбце days_employed и медиана для total_income. Далее эти значения использовались  для заполнения пропусков и замены типа данных. Замена происходила методом .astype(int), а заполнение - .fillna().\n",
    "В информации о таблице видно, что тип данных в данных столбцах поменялся.\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Обработка дубликатов"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Количество дубликатов: 71\n",
      "Количество дубликатов: 0\n",
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 21353 entries, 0 to 21352\n",
      "Data columns (total 12 columns):\n",
      "children            21353 non-null int64\n",
      "days_employed       21353 non-null int64\n",
      "dob_years           21353 non-null int64\n",
      "education           21353 non-null object\n",
      "education_id        21353 non-null int64\n",
      "family_status       21353 non-null object\n",
      "family_status_id    21353 non-null int64\n",
      "gender              21353 non-null object\n",
      "income_type         21353 non-null object\n",
      "debt                21353 non-null int64\n",
      "total_income        21353 non-null int64\n",
      "purpose             21353 non-null object\n",
      "dtypes: int64(7), object(5)\n",
      "memory usage: 2.0+ MB\n"
     ]
    }
   ],
   "source": [
    "print('Количество дубликатов:', clients.duplicated().sum())\n",
    "clients = clients.drop_duplicates().reset_index(drop = True)\n",
    "print('Количество дубликатов:', clients.duplicated().sum())\n",
    "clients.info()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Вывод"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "На этом шаге были приведены в нижний регистр значения из столбца education.\n",
    "После этого были удалены дубликаты методом .drop_duplicates(). Кроме этого использовался метод .reset_index(drop = True), для переиндексации объектов.\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Лемматизация"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "свадьба                                   786\n",
      "на проведение свадьбы                     764\n",
      "сыграть свадьбу                           760\n",
      "операции с недвижимостью                  672\n",
      "покупка коммерческой недвижимости         658\n",
      "покупка жилья для сдачи                   649\n",
      "операции с коммерческой недвижимостью     648\n",
      "операции с жильем                         646\n",
      "покупка жилья                             640\n",
      "жилье                                     640\n",
      "покупка жилья для семьи                   637\n",
      "строительство собственной недвижимости    633\n",
      "недвижимость                              629\n",
      "операции со своей недвижимостью           627\n",
      "строительство жилой недвижимости          621\n",
      "строительство недвижимости                619\n",
      "покупка своего жилья                      619\n",
      "покупка недвижимости                      618\n",
      "ремонт жилью                              605\n",
      "покупка жилой недвижимости                603\n",
      "на покупку своего автомобиля              502\n",
      "заняться высшим образованием              493\n",
      "автомобиль                                490\n",
      "сделка с подержанным автомобилем          484\n",
      "на покупку подержанного автомобиля        478\n",
      "автомобили                                476\n",
      "свой автомобиль                           475\n",
      "на покупку автомобиля                     466\n",
      "приобретение автомобиля                   459\n",
      "дополнительное образование                458\n",
      "сделка с автомобилем                      454\n",
      "высшее образование                        449\n",
      "получение дополнительного образования     444\n",
      "образование                               444\n",
      "получение образования                     441\n",
      "профильное образование                    435\n",
      "получение высшего образования             424\n",
      "заняться образованием                     407\n",
      "Name: purpose, dtype: int64\n",
      "    children  days_employed  dob_years            education  education_id  \\\n",
      "0          1           8437         42               высшее             0   \n",
      "1          1           4024         36              среднее             1   \n",
      "2          0           5623         33              среднее             1   \n",
      "3          3           4124         32              среднее             1   \n",
      "4          0          14177         53              среднее             1   \n",
      "5          0            926         27               высшее             0   \n",
      "6          0           2879         43               высшее             0   \n",
      "7          0            152         50              среднее             1   \n",
      "8          2           6929         35               высшее             0   \n",
      "9          0           2188         41              среднее             1   \n",
      "10         2           4171         36               высшее             0   \n",
      "11         0            792         40              среднее             1   \n",
      "12         0           4678         65              среднее             1   \n",
      "13         0           1846         54  неоконченное высшее             2   \n",
      "14         0           1844         56               высшее             0   \n",
      "15         1            972         26              среднее             1   \n",
      "16         0           1719         35              среднее             1   \n",
      "17         0           2369         33               высшее             0   \n",
      "18         0          16678         53              среднее             1   \n",
      "19         0          10038         48              среднее             1   \n",
      "20         1           1311         36              среднее             1   \n",
      "21         1            253         33              среднее             1   \n",
      "22         1           1766         24              среднее             1   \n",
      "23         0            272         21               высшее             0   \n",
      "24         1          14106         57              среднее             1   \n",
      "25         0          15147         67              среднее             1   \n",
      "26         0           4678         41              среднее             1   \n",
      "27         0            529         28               высшее             0   \n",
      "28         1            717         26               высшее             0   \n",
      "29         0           4678         63              среднее             1   \n",
      "30         1          13982         62              среднее             1   \n",
      "31         0           1682         47            начальное             3   \n",
      "32         0           4649         34              среднее             1   \n",
      "33         0           1548         48              среднее             1   \n",
      "34         0           4488         35              среднее             1   \n",
      "35         0          16417         68              среднее             1   \n",
      "36         0            176         33              среднее             1   \n",
      "37         0           6448         43               высшее             0   \n",
      "38         0            597         25               высшее             0   \n",
      "39         0            650         31               высшее             0   \n",
      "40         0           1030         30              среднее             1   \n",
      "41         0           4678         50              среднее             1   \n",
      "42         0           1257         20  неоконченное высшее             2   \n",
      "43         0           4375         43  неоконченное высшее             2   \n",
      "44         1           1362         26              среднее             1   \n",
      "45         1           1039         49              среднее             1   \n",
      "46         2           2262         37              среднее             1   \n",
      "47         1           2689         33               высшее             0   \n",
      "48         0           3341         45              среднее             1   \n",
      "49         0           1181         54              среднее             1   \n",
      "\n",
      "            family_status  family_status_id gender  income_type  debt  \\\n",
      "0         женат / замужем                 0      F    сотрудник     0   \n",
      "1         женат / замужем                 0      F    сотрудник     0   \n",
      "2         женат / замужем                 0      M    сотрудник     0   \n",
      "3         женат / замужем                 0      M    сотрудник     0   \n",
      "4        гражданский брак                 1      F    пенсионер     0   \n",
      "5        гражданский брак                 1      M    компаньон     0   \n",
      "6         женат / замужем                 0      F    компаньон     0   \n",
      "7         женат / замужем                 0      M    сотрудник     0   \n",
      "8        гражданский брак                 1      F    сотрудник     0   \n",
      "9         женат / замужем                 0      M    сотрудник     0   \n",
      "10        женат / замужем                 0      M    компаньон     0   \n",
      "11        женат / замужем                 0      F    сотрудник     0   \n",
      "12       гражданский брак                 1      M    пенсионер     0   \n",
      "13        женат / замужем                 0      F    сотрудник     0   \n",
      "14       гражданский брак                 1      F    компаньон     1   \n",
      "15        женат / замужем                 0      F    сотрудник     0   \n",
      "16        женат / замужем                 0      F    сотрудник     0   \n",
      "17       гражданский брак                 1      M    сотрудник     0   \n",
      "18         вдовец / вдова                 2      F    пенсионер     0   \n",
      "19              в разводе                 3      F    сотрудник     0   \n",
      "20        женат / замужем                 0      M    сотрудник     0   \n",
      "21       гражданский брак                 1      F    сотрудник     0   \n",
      "22       гражданский брак                 1      F    сотрудник     0   \n",
      "23       гражданский брак                 1      M    сотрудник     0   \n",
      "24  Не женат / не замужем                 4      F    пенсионер     0   \n",
      "25        женат / замужем                 0      M    пенсионер     0   \n",
      "26        женат / замужем                 0      M  госслужащий     0   \n",
      "27        женат / замужем                 0      M    сотрудник     0   \n",
      "28        женат / замужем                 0      F    сотрудник     0   \n",
      "29  Не женат / не замужем                 4      F    пенсионер     0   \n",
      "30        женат / замужем                 0      F    пенсионер     0   \n",
      "31        женат / замужем                 0      F    сотрудник     0   \n",
      "32       гражданский брак                 1      F    сотрудник     1   \n",
      "33        женат / замужем                 0      F    компаньон     0   \n",
      "34        женат / замужем                 0      F    сотрудник     0   \n",
      "35       гражданский брак                 1      M    пенсионер     0   \n",
      "36  Не женат / не замужем                 4      M    сотрудник     0   \n",
      "37       гражданский брак                 1      F    компаньон     0   \n",
      "38  Не женат / не замужем                 4      M    сотрудник     1   \n",
      "39       гражданский брак                 1      F    компаньон     0   \n",
      "40  Не женат / не замужем                 4      M    компаньон     0   \n",
      "41        женат / замужем                 0      F  госслужащий     0   \n",
      "42  Не женат / не замужем                 4      F    сотрудник     0   \n",
      "43              в разводе                 3      F    компаньон     0   \n",
      "44        женат / замужем                 0      F    сотрудник     0   \n",
      "45  Не женат / не замужем                 4      F    сотрудник     0   \n",
      "46        женат / замужем                 0      F    компаньон     0   \n",
      "47       гражданский брак                 1      M  госслужащий     0   \n",
      "48        женат / замужем                 0      F    сотрудник     0   \n",
      "49        женат / замужем                 0      F    сотрудник     0   \n",
      "\n",
      "    total_income                                 purpose  \\\n",
      "0         253875                           покупка жилья   \n",
      "1         112080                 приобретение автомобиля   \n",
      "2         145885                           покупка жилья   \n",
      "3         267628              дополнительное образование   \n",
      "4         158616                         сыграть свадьбу   \n",
      "5         255763                           покупка жилья   \n",
      "6         240525                       операции с жильем   \n",
      "7         135823                             образование   \n",
      "8          95856                   на проведение свадьбы   \n",
      "9         144425                 покупка жилья для семьи   \n",
      "10        113943                    покупка недвижимости   \n",
      "11         77069       покупка коммерческой недвижимости   \n",
      "12        153752                         сыграть свадьбу   \n",
      "13        130458                 приобретение автомобиля   \n",
      "14        165127              покупка жилой недвижимости   \n",
      "15        116820  строительство собственной недвижимости   \n",
      "16        289202                            недвижимость   \n",
      "17         90410              строительство недвижимости   \n",
      "18         56823      на покупку подержанного автомобиля   \n",
      "19        242831            на покупку своего автомобиля   \n",
      "20        209552                            недвижимость   \n",
      "21        131812                 приобретение автомобиля   \n",
      "22        149681      на покупку подержанного автомобиля   \n",
      "23        128265                         сыграть свадьбу   \n",
      "24        290547   операции с коммерческой недвижимостью   \n",
      "25         55112                    покупка недвижимости   \n",
      "26        153752                             образование   \n",
      "27        308848  строительство собственной недвижимости   \n",
      "28        187863  строительство собственной недвижимости   \n",
      "29        153752        строительство жилой недвижимости   \n",
      "30        171456   операции с коммерческой недвижимостью   \n",
      "31        275485                                   жилье   \n",
      "32        139057                   на проведение свадьбы   \n",
      "33        157245                           покупка жилья   \n",
      "34        104660         операции со своей недвижимостью   \n",
      "35         77805                   на проведение свадьбы   \n",
      "36        138830                              автомобили   \n",
      "37        154128                 приобретение автомобиля   \n",
      "38        192247                             образование   \n",
      "39        754240                   заняться образованием   \n",
      "40        142865                    покупка недвижимости   \n",
      "41        153752        сделка с подержанным автомобилем   \n",
      "42         82065                   получение образования   \n",
      "43        272957                 приобретение автомобиля   \n",
      "44        100780            на покупку своего автомобиля   \n",
      "45        106385                   заняться образованием   \n",
      "46        182682        сделка с подержанным автомобилем   \n",
      "47        356277                   на проведение свадьбы   \n",
      "48        162065  строительство собственной недвижимости   \n",
      "49         44591                              автомобиль   \n",
      "\n",
      "                                               lemmas  \\\n",
      "0                             [покупка,  , жилье, \\n]   \n",
      "1                   [приобретение,  , автомобиль, \\n]   \n",
      "2                             [покупка,  , жилье, \\n]   \n",
      "3                [дополнительный,  , образование, \\n]   \n",
      "4                           [сыграть,  , свадьба, \\n]   \n",
      "5                             [покупка,  , жилье, \\n]   \n",
      "6                      [операция,  , с,  , жилье, \\n]   \n",
      "7                                   [образование, \\n]   \n",
      "8                 [на,  , проведение,  , свадьба, \\n]   \n",
      "9           [покупка,  , жилье,  , для,  , семья, \\n]   \n",
      "10                     [покупка,  , недвижимость, \\n]   \n",
      "11    [покупка,  , коммерческий,  , недвижимость, \\n]   \n",
      "12                          [сыграть,  , свадьба, \\n]   \n",
      "13                  [приобретение,  , автомобиль, \\n]   \n",
      "14           [покупка,  , жилой,  , недвижимость, \\n]   \n",
      "15  [строительство,  , собственный,  , недвижимост...   \n",
      "16                                 [недвижимость, \\n]   \n",
      "17               [строительство,  , недвижимость, \\n]   \n",
      "18  [на,  , покупка,  , подержать,  , автомобиль, \\n]   \n",
      "19       [на,  , покупка,  , свой,  , автомобиль, \\n]   \n",
      "20                                 [недвижимость, \\n]   \n",
      "21                  [приобретение,  , автомобиль, \\n]   \n",
      "22  [на,  , покупка,  , подержать,  , автомобиль, \\n]   \n",
      "23                          [сыграть,  , свадьба, \\n]   \n",
      "24  [операция,  , с,  , коммерческий,  , недвижимо...   \n",
      "25                     [покупка,  , недвижимость, \\n]   \n",
      "26                                  [образование, \\n]   \n",
      "27  [строительство,  , собственный,  , недвижимост...   \n",
      "28  [строительство,  , собственный,  , недвижимост...   \n",
      "29     [строительство,  , жилой,  , недвижимость, \\n]   \n",
      "30  [операция,  , с,  , коммерческий,  , недвижимо...   \n",
      "31                                        [жилье, \\n]   \n",
      "32                [на,  , проведение,  , свадьба, \\n]   \n",
      "33                            [покупка,  , жилье, \\n]   \n",
      "34    [операция,  , со,  , свой,  , недвижимость, \\n]   \n",
      "35                [на,  , проведение,  , свадьба, \\n]   \n",
      "36                                   [автомобиль, \\n]   \n",
      "37                  [приобретение,  , автомобиль, \\n]   \n",
      "38                                  [образование, \\n]   \n",
      "39                   [заниматься,  , образование, \\n]   \n",
      "40                     [покупка,  , недвижимость, \\n]   \n",
      "41  [сделка,  , с,  , подержанный,  , автомобиль, \\n]   \n",
      "42                    [получение,  , образование, \\n]   \n",
      "43                  [приобретение,  , автомобиль, \\n]   \n",
      "44       [на,  , покупка,  , свой,  , автомобиль, \\n]   \n",
      "45                   [заниматься,  , образование, \\n]   \n",
      "46  [сделка,  , с,  , подержанный,  , автомобиль, \\n]   \n",
      "47                [на,  , проведение,  , свадьба, \\n]   \n",
      "48  [строительство,  , собственный,  , недвижимост...   \n",
      "49                                   [автомобиль, \\n]   \n",
      "\n",
      "                 purpose_group  \n",
      "0                        жилье  \n",
      "1                   автомобиль  \n",
      "2                        жилье  \n",
      "3                  образование  \n",
      "4                      свадьба  \n",
      "5                        жилье  \n",
      "6                        жилье  \n",
      "7                  образование  \n",
      "8                      свадьба  \n",
      "9                        жилье  \n",
      "10                       жилье  \n",
      "11   коммерческая недвижимость  \n",
      "12                     свадьба  \n",
      "13                  автомобиль  \n",
      "14                       жилье  \n",
      "15  строительство недвижимости  \n",
      "16                       жилье  \n",
      "17  строительство недвижимости  \n",
      "18                  автомобиль  \n",
      "19                  автомобиль  \n",
      "20                       жилье  \n",
      "21                  автомобиль  \n",
      "22                  автомобиль  \n",
      "23                     свадьба  \n",
      "24   коммерческая недвижимость  \n",
      "25                       жилье  \n",
      "26                 образование  \n",
      "27  строительство недвижимости  \n",
      "28  строительство недвижимости  \n",
      "29  строительство недвижимости  \n",
      "30   коммерческая недвижимость  \n",
      "31                       жилье  \n",
      "32                     свадьба  \n",
      "33                       жилье  \n",
      "34                       жилье  \n",
      "35                     свадьба  \n",
      "36                  автомобиль  \n",
      "37                  автомобиль  \n",
      "38                 образование  \n",
      "39                 образование  \n",
      "40                       жилье  \n",
      "41                  автомобиль  \n",
      "42                 образование  \n",
      "43                  автомобиль  \n",
      "44                  автомобиль  \n",
      "45                 образование  \n",
      "46                  автомобиль  \n",
      "47                     свадьба  \n",
      "48  строительство недвижимости  \n",
      "49                  автомобиль  \n"
     ]
    }
   ],
   "source": [
    "print(clients['purpose'].value_counts())\n",
    "\n",
    "m = Mystem()\n",
    "clients['lemmas'] = clients['purpose'].apply(m.lemmatize)\n",
    "def get_group(x):\n",
    "    if 'свадьба' in x:\n",
    "        return 'свадьба'\n",
    "    if 'образование' in x or 'учеба' in x:\n",
    "        return 'образование'\n",
    "    if 'строительство' in x:\n",
    "        return 'строительство недвижимости'\n",
    "    if 'ремонт' in x:\n",
    "        return 'улучшение жилья'\n",
    "    if 'коммерческий' in x or 'сдача' in x:\n",
    "        return 'коммерческая недвижимость'\n",
    "    if 'жилье' in x or 'недвижимость' in x:\n",
    "        return 'жилье'\n",
    "    if 'автомобиль' in x or 'машина' in x:\n",
    "        return 'автомобиль'  \n",
    "    return 'другое'\n",
    "clients['purpose_group'] = clients['lemmas'].apply(get_group)\n",
    "print(clients.head(50))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Вывод"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Были отобраны уникальные цели кредитов, по которым дальше проходила лемматизация:\n",
    " - свадьба\n",
    " - образование\n",
    " - строительство\n",
    " - ремонт\n",
    " - коммерческая недвижимость\n",
    " - свое жилье\n",
    " - автомобиль\n",
    "\n",
    "Далее проходила сама лемматизация:\n",
    " - подключение нужной библеотеки (Mystem)\n",
    " - создание столбца с леммами по заданному столбцу\n",
    " - написание функции для группировки лемм\n",
    " - создание нового столбца по сгруппированным целям, применение функции\n",
    " - проверка данных"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<h2> Комментарий студента</h2>\n",
    "\n",
    "Выбор лемм основывался исходя из ункальных смысловых значений, которые были указаны в качестве цели кредита. Например, следующие цели имеют одинаковый смысл, поэтому и объединены в одну группу.\n",
    " - приобретение автомобиля, \n",
    " - на покупку своего автомобиля, \n",
    " - автомобили, \n",
    " - автомобиль,\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Категоризация данных"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "20667\n",
      "2265604\n",
      "0.2     98553.4\n",
      "0.4    135265.0\n",
      "0.6    162280.6\n",
      "0.8    214557.4\n",
      "Name: total_income, dtype: float64\n"
     ]
    }
   ],
   "source": [
    "print(clients['total_income'].min())\n",
    "print(clients['total_income'].max())\n",
    "\n",
    "levels_income = clients['total_income'].quantile([0.2,0.4,0.6,0.8])\n",
    "print(levels_income)\n",
    "\n",
    "def income_group(total_income):\n",
    "    if total_income < levels_income[0.2]:\n",
    "        return 'низкий'\n",
    "    if total_income >= levels_income[0.2] and total_income < levels_income[0.4]:\n",
    "        return 'средний'\n",
    "    if total_income >= levels_income[0.4] and total_income < levels_income[0.6]:\n",
    "        return 'выше среднего'\n",
    "    if total_income >= levels_income[0.6] and total_income < levels_income[0.8]:\n",
    "        return 'высокий'\n",
    "    if total_income >= levels_income[0.8]:\n",
    "        return 'очень высокий'\n",
    "    \n",
    "def children_group(children):\n",
    "    if children == 0:\n",
    "        return 'без детей'\n",
    "    if children == 1:\n",
    "        return 'один ребенок'\n",
    "    if children >= 2:\n",
    "        return 'многодетная семья'\n",
    "    \n",
    "def category_clients(row):\n",
    "    debt = row['debt']\n",
    "    income_group = row['income_group']\n",
    "    \n",
    "    if income_group == 'очень высокий' or income_group == 'высокий' :\n",
    "        if debt == 0:\n",
    "            return 'элитный клиент'\n",
    "        \n",
    "    if income_group == 'средний' or income_group == 'выше среднего':\n",
    "        if debt == 0:\n",
    "            return 'доверительный клиент'\n",
    "    \n",
    "    if income_group == 'низкий':\n",
    "        if debt == 0:\n",
    "            return 'потенциально опасный клиент'\n",
    "\n",
    "    if income_group == 'низкий':\n",
    "        if debt == 1:\n",
    "            return 'опасный клиент'\n",
    "\n",
    "    if income_group == 1:\n",
    "            return 'сомнительный клиент'\n",
    "    \n",
    "    return 'нормальный клиент'\n",
    "\n",
    "\n",
    "clients['income_group'] = clients['total_income'].apply(income_group)\n",
    "clients['children_group'] = clients['children'].apply(children_group)\n",
    "clients['category_clients'] = clients.apply(category_clients, axis=1)\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [],
   "source": [
    "def family_status_clients(row):\n",
    "    family_status = row['family_status']\n",
    "    gender = row['gender']\n",
    "    \n",
    "    if gender == 'F' :\n",
    "        if family_status == 'женат / замужем':\n",
    "            return 'замужем'\n",
    "        if family_status == 'гражданский брак':\n",
    "            return 'женщина в гражданском браке'\n",
    "        if family_status == 'вдовец / вдова':\n",
    "            return 'вдова'\n",
    "        if family_status == 'в разводе':\n",
    "            return 'женщина в разводе'   \n",
    "        if family_status == 'Не женат / не замужем':\n",
    "            return 'не замужем'  \n",
    "    if gender == 'M' :\n",
    "        if family_status == 'женат / замужем':\n",
    "            return 'женат'\n",
    "        if family_status == 'гражданский брак':\n",
    "            return 'мужчина в гражданском браке'\n",
    "        if family_status == 'вдовец / вдова':\n",
    "            return 'вдовец'\n",
    "        if family_status == 'в разводе':\n",
    "            return 'мужчина в разводе'   \n",
    "        if family_status == 'Не женат / не замужем':\n",
    "            return 'не женат'  \n",
    "\n",
    "clients['family_status_clients'] = clients.apply(family_status_clients, axis=1)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [],
   "source": [
    "def education_status_clients(row):\n",
    "    education = row['education']\n",
    "    gender = row['gender']\n",
    "    \n",
    "    if gender == 'F' :\n",
    "        if education == 'высшее':\n",
    "            return 'женщина с высшим образованием'\n",
    "        if education == 'среднее':\n",
    "            return 'женщина с средним образованием'\n",
    "        if education == 'неоконоченное высшее':\n",
    "            return 'женщина с неоконченным высшим образованием'\n",
    "        if education == 'начальное':\n",
    "            return 'женщина с начальным образованием'\n",
    "        if education == 'ученая степень':\n",
    "            return 'женщина с ученой степенью'\n",
    "    if gender == 'M' :\n",
    "        if education == 'высшее':\n",
    "            return 'мужчина с высшим образованием'\n",
    "        if education == 'среднее':\n",
    "            return 'мужчина с средним образованием'\n",
    "        if education == 'неоконоченное высшее':\n",
    "            return 'мужчина с неоконченным высшим образованием'\n",
    "        if education == 'начальное':\n",
    "            return 'мужчина с начальным образованием'\n",
    "        if education == 'ученая степень':\n",
    "            return 'мужчина с ученой степенью'\n",
    "\n",
    "clients['education_status_clients'] = clients.apply(education_status_clients, axis=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>children</th>\n",
       "      <th>days_employed</th>\n",
       "      <th>dob_years</th>\n",
       "      <th>education</th>\n",
       "      <th>education_id</th>\n",
       "      <th>family_status</th>\n",
       "      <th>family_status_id</th>\n",
       "      <th>gender</th>\n",
       "      <th>income_type</th>\n",
       "      <th>debt</th>\n",
       "      <th>total_income</th>\n",
       "      <th>purpose</th>\n",
       "      <th>lemmas</th>\n",
       "      <th>purpose_group</th>\n",
       "      <th>income_group</th>\n",
       "      <th>children_group</th>\n",
       "      <th>category_clients</th>\n",
       "      <th>family_status_clients</th>\n",
       "      <th>education_status_clients</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>8437</td>\n",
       "      <td>42</td>\n",
       "      <td>высшее</td>\n",
       "      <td>0</td>\n",
       "      <td>женат / замужем</td>\n",
       "      <td>0</td>\n",
       "      <td>F</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>0</td>\n",
       "      <td>253875</td>\n",
       "      <td>покупка жилья</td>\n",
       "      <td>[покупка,  , жилье, \\n]</td>\n",
       "      <td>жилье</td>\n",
       "      <td>очень высокий</td>\n",
       "      <td>один ребенок</td>\n",
       "      <td>элитный клиент</td>\n",
       "      <td>замужем</td>\n",
       "      <td>женщина с высшим образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>4024</td>\n",
       "      <td>36</td>\n",
       "      <td>среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>женат / замужем</td>\n",
       "      <td>0</td>\n",
       "      <td>F</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>0</td>\n",
       "      <td>112080</td>\n",
       "      <td>приобретение автомобиля</td>\n",
       "      <td>[приобретение,  , автомобиль, \\n]</td>\n",
       "      <td>автомобиль</td>\n",
       "      <td>средний</td>\n",
       "      <td>один ребенок</td>\n",
       "      <td>доверительный клиент</td>\n",
       "      <td>замужем</td>\n",
       "      <td>женщина с средним образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>5623</td>\n",
       "      <td>33</td>\n",
       "      <td>среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>женат / замужем</td>\n",
       "      <td>0</td>\n",
       "      <td>M</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>0</td>\n",
       "      <td>145885</td>\n",
       "      <td>покупка жилья</td>\n",
       "      <td>[покупка,  , жилье, \\n]</td>\n",
       "      <td>жилье</td>\n",
       "      <td>выше среднего</td>\n",
       "      <td>без детей</td>\n",
       "      <td>доверительный клиент</td>\n",
       "      <td>женат</td>\n",
       "      <td>мужчина с средним образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>4124</td>\n",
       "      <td>32</td>\n",
       "      <td>среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>женат / замужем</td>\n",
       "      <td>0</td>\n",
       "      <td>M</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>0</td>\n",
       "      <td>267628</td>\n",
       "      <td>дополнительное образование</td>\n",
       "      <td>[дополнительный,  , образование, \\n]</td>\n",
       "      <td>образование</td>\n",
       "      <td>очень высокий</td>\n",
       "      <td>многодетная семья</td>\n",
       "      <td>элитный клиент</td>\n",
       "      <td>женат</td>\n",
       "      <td>мужчина с средним образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>14177</td>\n",
       "      <td>53</td>\n",
       "      <td>среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>гражданский брак</td>\n",
       "      <td>1</td>\n",
       "      <td>F</td>\n",
       "      <td>пенсионер</td>\n",
       "      <td>0</td>\n",
       "      <td>158616</td>\n",
       "      <td>сыграть свадьбу</td>\n",
       "      <td>[сыграть,  , свадьба, \\n]</td>\n",
       "      <td>свадьба</td>\n",
       "      <td>выше среднего</td>\n",
       "      <td>без детей</td>\n",
       "      <td>доверительный клиент</td>\n",
       "      <td>женщина в гражданском браке</td>\n",
       "      <td>женщина с средним образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>926</td>\n",
       "      <td>27</td>\n",
       "      <td>высшее</td>\n",
       "      <td>0</td>\n",
       "      <td>гражданский брак</td>\n",
       "      <td>1</td>\n",
       "      <td>M</td>\n",
       "      <td>компаньон</td>\n",
       "      <td>0</td>\n",
       "      <td>255763</td>\n",
       "      <td>покупка жилья</td>\n",
       "      <td>[покупка,  , жилье, \\n]</td>\n",
       "      <td>жилье</td>\n",
       "      <td>очень высокий</td>\n",
       "      <td>без детей</td>\n",
       "      <td>элитный клиент</td>\n",
       "      <td>мужчина в гражданском браке</td>\n",
       "      <td>мужчина с высшим образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>2879</td>\n",
       "      <td>43</td>\n",
       "      <td>высшее</td>\n",
       "      <td>0</td>\n",
       "      <td>женат / замужем</td>\n",
       "      <td>0</td>\n",
       "      <td>F</td>\n",
       "      <td>компаньон</td>\n",
       "      <td>0</td>\n",
       "      <td>240525</td>\n",
       "      <td>операции с жильем</td>\n",
       "      <td>[операция,  , с,  , жилье, \\n]</td>\n",
       "      <td>жилье</td>\n",
       "      <td>очень высокий</td>\n",
       "      <td>без детей</td>\n",
       "      <td>элитный клиент</td>\n",
       "      <td>замужем</td>\n",
       "      <td>женщина с высшим образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>7</td>\n",
       "      <td>0</td>\n",
       "      <td>152</td>\n",
       "      <td>50</td>\n",
       "      <td>среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>женат / замужем</td>\n",
       "      <td>0</td>\n",
       "      <td>M</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>0</td>\n",
       "      <td>135823</td>\n",
       "      <td>образование</td>\n",
       "      <td>[образование, \\n]</td>\n",
       "      <td>образование</td>\n",
       "      <td>выше среднего</td>\n",
       "      <td>без детей</td>\n",
       "      <td>доверительный клиент</td>\n",
       "      <td>женат</td>\n",
       "      <td>мужчина с средним образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>8</td>\n",
       "      <td>2</td>\n",
       "      <td>6929</td>\n",
       "      <td>35</td>\n",
       "      <td>высшее</td>\n",
       "      <td>0</td>\n",
       "      <td>гражданский брак</td>\n",
       "      <td>1</td>\n",
       "      <td>F</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>0</td>\n",
       "      <td>95856</td>\n",
       "      <td>на проведение свадьбы</td>\n",
       "      <td>[на,  , проведение,  , свадьба, \\n]</td>\n",
       "      <td>свадьба</td>\n",
       "      <td>низкий</td>\n",
       "      <td>многодетная семья</td>\n",
       "      <td>потенциально опасный клиент</td>\n",
       "      <td>женщина в гражданском браке</td>\n",
       "      <td>женщина с высшим образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>9</td>\n",
       "      <td>0</td>\n",
       "      <td>2188</td>\n",
       "      <td>41</td>\n",
       "      <td>среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>женат / замужем</td>\n",
       "      <td>0</td>\n",
       "      <td>M</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>0</td>\n",
       "      <td>144425</td>\n",
       "      <td>покупка жилья для семьи</td>\n",
       "      <td>[покупка,  , жилье,  , для,  , семья, \\n]</td>\n",
       "      <td>жилье</td>\n",
       "      <td>выше среднего</td>\n",
       "      <td>без детей</td>\n",
       "      <td>доверительный клиент</td>\n",
       "      <td>женат</td>\n",
       "      <td>мужчина с средним образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>10</td>\n",
       "      <td>2</td>\n",
       "      <td>4171</td>\n",
       "      <td>36</td>\n",
       "      <td>высшее</td>\n",
       "      <td>0</td>\n",
       "      <td>женат / замужем</td>\n",
       "      <td>0</td>\n",
       "      <td>M</td>\n",
       "      <td>компаньон</td>\n",
       "      <td>0</td>\n",
       "      <td>113943</td>\n",
       "      <td>покупка недвижимости</td>\n",
       "      <td>[покупка,  , недвижимость, \\n]</td>\n",
       "      <td>жилье</td>\n",
       "      <td>средний</td>\n",
       "      <td>многодетная семья</td>\n",
       "      <td>доверительный клиент</td>\n",
       "      <td>женат</td>\n",
       "      <td>мужчина с высшим образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>11</td>\n",
       "      <td>0</td>\n",
       "      <td>792</td>\n",
       "      <td>40</td>\n",
       "      <td>среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>женат / замужем</td>\n",
       "      <td>0</td>\n",
       "      <td>F</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>0</td>\n",
       "      <td>77069</td>\n",
       "      <td>покупка коммерческой недвижимости</td>\n",
       "      <td>[покупка,  , коммерческий,  , недвижимость, \\n]</td>\n",
       "      <td>коммерческая недвижимость</td>\n",
       "      <td>низкий</td>\n",
       "      <td>без детей</td>\n",
       "      <td>потенциально опасный клиент</td>\n",
       "      <td>замужем</td>\n",
       "      <td>женщина с средним образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>12</td>\n",
       "      <td>0</td>\n",
       "      <td>4678</td>\n",
       "      <td>65</td>\n",
       "      <td>среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>гражданский брак</td>\n",
       "      <td>1</td>\n",
       "      <td>M</td>\n",
       "      <td>пенсионер</td>\n",
       "      <td>0</td>\n",
       "      <td>153752</td>\n",
       "      <td>сыграть свадьбу</td>\n",
       "      <td>[сыграть,  , свадьба, \\n]</td>\n",
       "      <td>свадьба</td>\n",
       "      <td>выше среднего</td>\n",
       "      <td>без детей</td>\n",
       "      <td>доверительный клиент</td>\n",
       "      <td>мужчина в гражданском браке</td>\n",
       "      <td>мужчина с средним образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>13</td>\n",
       "      <td>0</td>\n",
       "      <td>1846</td>\n",
       "      <td>54</td>\n",
       "      <td>неоконченное высшее</td>\n",
       "      <td>2</td>\n",
       "      <td>женат / замужем</td>\n",
       "      <td>0</td>\n",
       "      <td>F</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>0</td>\n",
       "      <td>130458</td>\n",
       "      <td>приобретение автомобиля</td>\n",
       "      <td>[приобретение,  , автомобиль, \\n]</td>\n",
       "      <td>автомобиль</td>\n",
       "      <td>средний</td>\n",
       "      <td>без детей</td>\n",
       "      <td>доверительный клиент</td>\n",
       "      <td>замужем</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>14</td>\n",
       "      <td>0</td>\n",
       "      <td>1844</td>\n",
       "      <td>56</td>\n",
       "      <td>высшее</td>\n",
       "      <td>0</td>\n",
       "      <td>гражданский брак</td>\n",
       "      <td>1</td>\n",
       "      <td>F</td>\n",
       "      <td>компаньон</td>\n",
       "      <td>1</td>\n",
       "      <td>165127</td>\n",
       "      <td>покупка жилой недвижимости</td>\n",
       "      <td>[покупка,  , жилой,  , недвижимость, \\n]</td>\n",
       "      <td>жилье</td>\n",
       "      <td>высокий</td>\n",
       "      <td>без детей</td>\n",
       "      <td>нормальный клиент</td>\n",
       "      <td>женщина в гражданском браке</td>\n",
       "      <td>женщина с высшим образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>15</td>\n",
       "      <td>1</td>\n",
       "      <td>972</td>\n",
       "      <td>26</td>\n",
       "      <td>среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>женат / замужем</td>\n",
       "      <td>0</td>\n",
       "      <td>F</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>0</td>\n",
       "      <td>116820</td>\n",
       "      <td>строительство собственной недвижимости</td>\n",
       "      <td>[строительство,  , собственный,  , недвижимост...</td>\n",
       "      <td>строительство недвижимости</td>\n",
       "      <td>средний</td>\n",
       "      <td>один ребенок</td>\n",
       "      <td>доверительный клиент</td>\n",
       "      <td>замужем</td>\n",
       "      <td>женщина с средним образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>16</td>\n",
       "      <td>0</td>\n",
       "      <td>1719</td>\n",
       "      <td>35</td>\n",
       "      <td>среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>женат / замужем</td>\n",
       "      <td>0</td>\n",
       "      <td>F</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>0</td>\n",
       "      <td>289202</td>\n",
       "      <td>недвижимость</td>\n",
       "      <td>[недвижимость, \\n]</td>\n",
       "      <td>жилье</td>\n",
       "      <td>очень высокий</td>\n",
       "      <td>без детей</td>\n",
       "      <td>элитный клиент</td>\n",
       "      <td>замужем</td>\n",
       "      <td>женщина с средним образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>17</td>\n",
       "      <td>0</td>\n",
       "      <td>2369</td>\n",
       "      <td>33</td>\n",
       "      <td>высшее</td>\n",
       "      <td>0</td>\n",
       "      <td>гражданский брак</td>\n",
       "      <td>1</td>\n",
       "      <td>M</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>0</td>\n",
       "      <td>90410</td>\n",
       "      <td>строительство недвижимости</td>\n",
       "      <td>[строительство,  , недвижимость, \\n]</td>\n",
       "      <td>строительство недвижимости</td>\n",
       "      <td>низкий</td>\n",
       "      <td>без детей</td>\n",
       "      <td>потенциально опасный клиент</td>\n",
       "      <td>мужчина в гражданском браке</td>\n",
       "      <td>мужчина с высшим образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>18</td>\n",
       "      <td>0</td>\n",
       "      <td>16678</td>\n",
       "      <td>53</td>\n",
       "      <td>среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>вдовец / вдова</td>\n",
       "      <td>2</td>\n",
       "      <td>F</td>\n",
       "      <td>пенсионер</td>\n",
       "      <td>0</td>\n",
       "      <td>56823</td>\n",
       "      <td>на покупку подержанного автомобиля</td>\n",
       "      <td>[на,  , покупка,  , подержать,  , автомобиль, \\n]</td>\n",
       "      <td>автомобиль</td>\n",
       "      <td>низкий</td>\n",
       "      <td>без детей</td>\n",
       "      <td>потенциально опасный клиент</td>\n",
       "      <td>вдова</td>\n",
       "      <td>женщина с средним образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>19</td>\n",
       "      <td>0</td>\n",
       "      <td>10038</td>\n",
       "      <td>48</td>\n",
       "      <td>среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>в разводе</td>\n",
       "      <td>3</td>\n",
       "      <td>F</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>0</td>\n",
       "      <td>242831</td>\n",
       "      <td>на покупку своего автомобиля</td>\n",
       "      <td>[на,  , покупка,  , свой,  , автомобиль, \\n]</td>\n",
       "      <td>автомобиль</td>\n",
       "      <td>очень высокий</td>\n",
       "      <td>без детей</td>\n",
       "      <td>элитный клиент</td>\n",
       "      <td>женщина в разводе</td>\n",
       "      <td>женщина с средним образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>20</td>\n",
       "      <td>1</td>\n",
       "      <td>1311</td>\n",
       "      <td>36</td>\n",
       "      <td>среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>женат / замужем</td>\n",
       "      <td>0</td>\n",
       "      <td>M</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>0</td>\n",
       "      <td>209552</td>\n",
       "      <td>недвижимость</td>\n",
       "      <td>[недвижимость, \\n]</td>\n",
       "      <td>жилье</td>\n",
       "      <td>высокий</td>\n",
       "      <td>один ребенок</td>\n",
       "      <td>элитный клиент</td>\n",
       "      <td>женат</td>\n",
       "      <td>мужчина с средним образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>21</td>\n",
       "      <td>1</td>\n",
       "      <td>253</td>\n",
       "      <td>33</td>\n",
       "      <td>среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>гражданский брак</td>\n",
       "      <td>1</td>\n",
       "      <td>F</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>0</td>\n",
       "      <td>131812</td>\n",
       "      <td>приобретение автомобиля</td>\n",
       "      <td>[приобретение,  , автомобиль, \\n]</td>\n",
       "      <td>автомобиль</td>\n",
       "      <td>средний</td>\n",
       "      <td>один ребенок</td>\n",
       "      <td>доверительный клиент</td>\n",
       "      <td>женщина в гражданском браке</td>\n",
       "      <td>женщина с средним образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>22</td>\n",
       "      <td>1</td>\n",
       "      <td>1766</td>\n",
       "      <td>24</td>\n",
       "      <td>среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>гражданский брак</td>\n",
       "      <td>1</td>\n",
       "      <td>F</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>0</td>\n",
       "      <td>149681</td>\n",
       "      <td>на покупку подержанного автомобиля</td>\n",
       "      <td>[на,  , покупка,  , подержать,  , автомобиль, \\n]</td>\n",
       "      <td>автомобиль</td>\n",
       "      <td>выше среднего</td>\n",
       "      <td>один ребенок</td>\n",
       "      <td>доверительный клиент</td>\n",
       "      <td>женщина в гражданском браке</td>\n",
       "      <td>женщина с средним образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>23</td>\n",
       "      <td>0</td>\n",
       "      <td>272</td>\n",
       "      <td>21</td>\n",
       "      <td>высшее</td>\n",
       "      <td>0</td>\n",
       "      <td>гражданский брак</td>\n",
       "      <td>1</td>\n",
       "      <td>M</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>0</td>\n",
       "      <td>128265</td>\n",
       "      <td>сыграть свадьбу</td>\n",
       "      <td>[сыграть,  , свадьба, \\n]</td>\n",
       "      <td>свадьба</td>\n",
       "      <td>средний</td>\n",
       "      <td>без детей</td>\n",
       "      <td>доверительный клиент</td>\n",
       "      <td>мужчина в гражданском браке</td>\n",
       "      <td>мужчина с высшим образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>24</td>\n",
       "      <td>1</td>\n",
       "      <td>14106</td>\n",
       "      <td>57</td>\n",
       "      <td>среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>Не женат / не замужем</td>\n",
       "      <td>4</td>\n",
       "      <td>F</td>\n",
       "      <td>пенсионер</td>\n",
       "      <td>0</td>\n",
       "      <td>290547</td>\n",
       "      <td>операции с коммерческой недвижимостью</td>\n",
       "      <td>[операция,  , с,  , коммерческий,  , недвижимо...</td>\n",
       "      <td>коммерческая недвижимость</td>\n",
       "      <td>очень высокий</td>\n",
       "      <td>один ребенок</td>\n",
       "      <td>элитный клиент</td>\n",
       "      <td>не замужем</td>\n",
       "      <td>женщина с средним образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>25</td>\n",
       "      <td>0</td>\n",
       "      <td>15147</td>\n",
       "      <td>67</td>\n",
       "      <td>среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>женат / замужем</td>\n",
       "      <td>0</td>\n",
       "      <td>M</td>\n",
       "      <td>пенсионер</td>\n",
       "      <td>0</td>\n",
       "      <td>55112</td>\n",
       "      <td>покупка недвижимости</td>\n",
       "      <td>[покупка,  , недвижимость, \\n]</td>\n",
       "      <td>жилье</td>\n",
       "      <td>низкий</td>\n",
       "      <td>без детей</td>\n",
       "      <td>потенциально опасный клиент</td>\n",
       "      <td>женат</td>\n",
       "      <td>мужчина с средним образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>26</td>\n",
       "      <td>0</td>\n",
       "      <td>4678</td>\n",
       "      <td>41</td>\n",
       "      <td>среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>женат / замужем</td>\n",
       "      <td>0</td>\n",
       "      <td>M</td>\n",
       "      <td>госслужащий</td>\n",
       "      <td>0</td>\n",
       "      <td>153752</td>\n",
       "      <td>образование</td>\n",
       "      <td>[образование, \\n]</td>\n",
       "      <td>образование</td>\n",
       "      <td>выше среднего</td>\n",
       "      <td>без детей</td>\n",
       "      <td>доверительный клиент</td>\n",
       "      <td>женат</td>\n",
       "      <td>мужчина с средним образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>27</td>\n",
       "      <td>0</td>\n",
       "      <td>529</td>\n",
       "      <td>28</td>\n",
       "      <td>высшее</td>\n",
       "      <td>0</td>\n",
       "      <td>женат / замужем</td>\n",
       "      <td>0</td>\n",
       "      <td>M</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>0</td>\n",
       "      <td>308848</td>\n",
       "      <td>строительство собственной недвижимости</td>\n",
       "      <td>[строительство,  , собственный,  , недвижимост...</td>\n",
       "      <td>строительство недвижимости</td>\n",
       "      <td>очень высокий</td>\n",
       "      <td>без детей</td>\n",
       "      <td>элитный клиент</td>\n",
       "      <td>женат</td>\n",
       "      <td>мужчина с высшим образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>28</td>\n",
       "      <td>1</td>\n",
       "      <td>717</td>\n",
       "      <td>26</td>\n",
       "      <td>высшее</td>\n",
       "      <td>0</td>\n",
       "      <td>женат / замужем</td>\n",
       "      <td>0</td>\n",
       "      <td>F</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>0</td>\n",
       "      <td>187863</td>\n",
       "      <td>строительство собственной недвижимости</td>\n",
       "      <td>[строительство,  , собственный,  , недвижимост...</td>\n",
       "      <td>строительство недвижимости</td>\n",
       "      <td>высокий</td>\n",
       "      <td>один ребенок</td>\n",
       "      <td>элитный клиент</td>\n",
       "      <td>замужем</td>\n",
       "      <td>женщина с высшим образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>29</td>\n",
       "      <td>0</td>\n",
       "      <td>4678</td>\n",
       "      <td>63</td>\n",
       "      <td>среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>Не женат / не замужем</td>\n",
       "      <td>4</td>\n",
       "      <td>F</td>\n",
       "      <td>пенсионер</td>\n",
       "      <td>0</td>\n",
       "      <td>153752</td>\n",
       "      <td>строительство жилой недвижимости</td>\n",
       "      <td>[строительство,  , жилой,  , недвижимость, \\n]</td>\n",
       "      <td>строительство недвижимости</td>\n",
       "      <td>выше среднего</td>\n",
       "      <td>без детей</td>\n",
       "      <td>доверительный клиент</td>\n",
       "      <td>не замужем</td>\n",
       "      <td>женщина с средним образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>30</td>\n",
       "      <td>1</td>\n",
       "      <td>13982</td>\n",
       "      <td>62</td>\n",
       "      <td>среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>женат / замужем</td>\n",
       "      <td>0</td>\n",
       "      <td>F</td>\n",
       "      <td>пенсионер</td>\n",
       "      <td>0</td>\n",
       "      <td>171456</td>\n",
       "      <td>операции с коммерческой недвижимостью</td>\n",
       "      <td>[операция,  , с,  , коммерческий,  , недвижимо...</td>\n",
       "      <td>коммерческая недвижимость</td>\n",
       "      <td>высокий</td>\n",
       "      <td>один ребенок</td>\n",
       "      <td>элитный клиент</td>\n",
       "      <td>замужем</td>\n",
       "      <td>женщина с средним образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>31</td>\n",
       "      <td>0</td>\n",
       "      <td>1682</td>\n",
       "      <td>47</td>\n",
       "      <td>начальное</td>\n",
       "      <td>3</td>\n",
       "      <td>женат / замужем</td>\n",
       "      <td>0</td>\n",
       "      <td>F</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>0</td>\n",
       "      <td>275485</td>\n",
       "      <td>жилье</td>\n",
       "      <td>[жилье, \\n]</td>\n",
       "      <td>жилье</td>\n",
       "      <td>очень высокий</td>\n",
       "      <td>без детей</td>\n",
       "      <td>элитный клиент</td>\n",
       "      <td>замужем</td>\n",
       "      <td>женщина с начальным образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>32</td>\n",
       "      <td>0</td>\n",
       "      <td>4649</td>\n",
       "      <td>34</td>\n",
       "      <td>среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>гражданский брак</td>\n",
       "      <td>1</td>\n",
       "      <td>F</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>1</td>\n",
       "      <td>139057</td>\n",
       "      <td>на проведение свадьбы</td>\n",
       "      <td>[на,  , проведение,  , свадьба, \\n]</td>\n",
       "      <td>свадьба</td>\n",
       "      <td>выше среднего</td>\n",
       "      <td>без детей</td>\n",
       "      <td>нормальный клиент</td>\n",
       "      <td>женщина в гражданском браке</td>\n",
       "      <td>женщина с средним образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>33</td>\n",
       "      <td>0</td>\n",
       "      <td>1548</td>\n",
       "      <td>48</td>\n",
       "      <td>среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>женат / замужем</td>\n",
       "      <td>0</td>\n",
       "      <td>F</td>\n",
       "      <td>компаньон</td>\n",
       "      <td>0</td>\n",
       "      <td>157245</td>\n",
       "      <td>покупка жилья</td>\n",
       "      <td>[покупка,  , жилье, \\n]</td>\n",
       "      <td>жилье</td>\n",
       "      <td>выше среднего</td>\n",
       "      <td>без детей</td>\n",
       "      <td>доверительный клиент</td>\n",
       "      <td>замужем</td>\n",
       "      <td>женщина с средним образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>34</td>\n",
       "      <td>0</td>\n",
       "      <td>4488</td>\n",
       "      <td>35</td>\n",
       "      <td>среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>женат / замужем</td>\n",
       "      <td>0</td>\n",
       "      <td>F</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>0</td>\n",
       "      <td>104660</td>\n",
       "      <td>операции со своей недвижимостью</td>\n",
       "      <td>[операция,  , со,  , свой,  , недвижимость, \\n]</td>\n",
       "      <td>жилье</td>\n",
       "      <td>средний</td>\n",
       "      <td>без детей</td>\n",
       "      <td>доверительный клиент</td>\n",
       "      <td>замужем</td>\n",
       "      <td>женщина с средним образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>35</td>\n",
       "      <td>0</td>\n",
       "      <td>16417</td>\n",
       "      <td>68</td>\n",
       "      <td>среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>гражданский брак</td>\n",
       "      <td>1</td>\n",
       "      <td>M</td>\n",
       "      <td>пенсионер</td>\n",
       "      <td>0</td>\n",
       "      <td>77805</td>\n",
       "      <td>на проведение свадьбы</td>\n",
       "      <td>[на,  , проведение,  , свадьба, \\n]</td>\n",
       "      <td>свадьба</td>\n",
       "      <td>низкий</td>\n",
       "      <td>без детей</td>\n",
       "      <td>потенциально опасный клиент</td>\n",
       "      <td>мужчина в гражданском браке</td>\n",
       "      <td>мужчина с средним образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>36</td>\n",
       "      <td>0</td>\n",
       "      <td>176</td>\n",
       "      <td>33</td>\n",
       "      <td>среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>Не женат / не замужем</td>\n",
       "      <td>4</td>\n",
       "      <td>M</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>0</td>\n",
       "      <td>138830</td>\n",
       "      <td>автомобили</td>\n",
       "      <td>[автомобиль, \\n]</td>\n",
       "      <td>автомобиль</td>\n",
       "      <td>выше среднего</td>\n",
       "      <td>без детей</td>\n",
       "      <td>доверительный клиент</td>\n",
       "      <td>не женат</td>\n",
       "      <td>мужчина с средним образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>37</td>\n",
       "      <td>0</td>\n",
       "      <td>6448</td>\n",
       "      <td>43</td>\n",
       "      <td>высшее</td>\n",
       "      <td>0</td>\n",
       "      <td>гражданский брак</td>\n",
       "      <td>1</td>\n",
       "      <td>F</td>\n",
       "      <td>компаньон</td>\n",
       "      <td>0</td>\n",
       "      <td>154128</td>\n",
       "      <td>приобретение автомобиля</td>\n",
       "      <td>[приобретение,  , автомобиль, \\n]</td>\n",
       "      <td>автомобиль</td>\n",
       "      <td>выше среднего</td>\n",
       "      <td>без детей</td>\n",
       "      <td>доверительный клиент</td>\n",
       "      <td>женщина в гражданском браке</td>\n",
       "      <td>женщина с высшим образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>38</td>\n",
       "      <td>0</td>\n",
       "      <td>597</td>\n",
       "      <td>25</td>\n",
       "      <td>высшее</td>\n",
       "      <td>0</td>\n",
       "      <td>Не женат / не замужем</td>\n",
       "      <td>4</td>\n",
       "      <td>M</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>1</td>\n",
       "      <td>192247</td>\n",
       "      <td>образование</td>\n",
       "      <td>[образование, \\n]</td>\n",
       "      <td>образование</td>\n",
       "      <td>высокий</td>\n",
       "      <td>без детей</td>\n",
       "      <td>нормальный клиент</td>\n",
       "      <td>не женат</td>\n",
       "      <td>мужчина с высшим образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>39</td>\n",
       "      <td>0</td>\n",
       "      <td>650</td>\n",
       "      <td>31</td>\n",
       "      <td>высшее</td>\n",
       "      <td>0</td>\n",
       "      <td>гражданский брак</td>\n",
       "      <td>1</td>\n",
       "      <td>F</td>\n",
       "      <td>компаньон</td>\n",
       "      <td>0</td>\n",
       "      <td>754240</td>\n",
       "      <td>заняться образованием</td>\n",
       "      <td>[заниматься,  , образование, \\n]</td>\n",
       "      <td>образование</td>\n",
       "      <td>очень высокий</td>\n",
       "      <td>без детей</td>\n",
       "      <td>элитный клиент</td>\n",
       "      <td>женщина в гражданском браке</td>\n",
       "      <td>женщина с высшим образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>40</td>\n",
       "      <td>0</td>\n",
       "      <td>1030</td>\n",
       "      <td>30</td>\n",
       "      <td>среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>Не женат / не замужем</td>\n",
       "      <td>4</td>\n",
       "      <td>M</td>\n",
       "      <td>компаньон</td>\n",
       "      <td>0</td>\n",
       "      <td>142865</td>\n",
       "      <td>покупка недвижимости</td>\n",
       "      <td>[покупка,  , недвижимость, \\n]</td>\n",
       "      <td>жилье</td>\n",
       "      <td>выше среднего</td>\n",
       "      <td>без детей</td>\n",
       "      <td>доверительный клиент</td>\n",
       "      <td>не женат</td>\n",
       "      <td>мужчина с средним образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>41</td>\n",
       "      <td>0</td>\n",
       "      <td>4678</td>\n",
       "      <td>50</td>\n",
       "      <td>среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>женат / замужем</td>\n",
       "      <td>0</td>\n",
       "      <td>F</td>\n",
       "      <td>госслужащий</td>\n",
       "      <td>0</td>\n",
       "      <td>153752</td>\n",
       "      <td>сделка с подержанным автомобилем</td>\n",
       "      <td>[сделка,  , с,  , подержанный,  , автомобиль, \\n]</td>\n",
       "      <td>автомобиль</td>\n",
       "      <td>выше среднего</td>\n",
       "      <td>без детей</td>\n",
       "      <td>доверительный клиент</td>\n",
       "      <td>замужем</td>\n",
       "      <td>женщина с средним образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>42</td>\n",
       "      <td>0</td>\n",
       "      <td>1257</td>\n",
       "      <td>20</td>\n",
       "      <td>неоконченное высшее</td>\n",
       "      <td>2</td>\n",
       "      <td>Не женат / не замужем</td>\n",
       "      <td>4</td>\n",
       "      <td>F</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>0</td>\n",
       "      <td>82065</td>\n",
       "      <td>получение образования</td>\n",
       "      <td>[получение,  , образование, \\n]</td>\n",
       "      <td>образование</td>\n",
       "      <td>низкий</td>\n",
       "      <td>без детей</td>\n",
       "      <td>потенциально опасный клиент</td>\n",
       "      <td>не замужем</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>43</td>\n",
       "      <td>0</td>\n",
       "      <td>4375</td>\n",
       "      <td>43</td>\n",
       "      <td>неоконченное высшее</td>\n",
       "      <td>2</td>\n",
       "      <td>в разводе</td>\n",
       "      <td>3</td>\n",
       "      <td>F</td>\n",
       "      <td>компаньон</td>\n",
       "      <td>0</td>\n",
       "      <td>272957</td>\n",
       "      <td>приобретение автомобиля</td>\n",
       "      <td>[приобретение,  , автомобиль, \\n]</td>\n",
       "      <td>автомобиль</td>\n",
       "      <td>очень высокий</td>\n",
       "      <td>без детей</td>\n",
       "      <td>элитный клиент</td>\n",
       "      <td>женщина в разводе</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>44</td>\n",
       "      <td>1</td>\n",
       "      <td>1362</td>\n",
       "      <td>26</td>\n",
       "      <td>среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>женат / замужем</td>\n",
       "      <td>0</td>\n",
       "      <td>F</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>0</td>\n",
       "      <td>100780</td>\n",
       "      <td>на покупку своего автомобиля</td>\n",
       "      <td>[на,  , покупка,  , свой,  , автомобиль, \\n]</td>\n",
       "      <td>автомобиль</td>\n",
       "      <td>средний</td>\n",
       "      <td>один ребенок</td>\n",
       "      <td>доверительный клиент</td>\n",
       "      <td>замужем</td>\n",
       "      <td>женщина с средним образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>45</td>\n",
       "      <td>1</td>\n",
       "      <td>1039</td>\n",
       "      <td>49</td>\n",
       "      <td>среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>Не женат / не замужем</td>\n",
       "      <td>4</td>\n",
       "      <td>F</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>0</td>\n",
       "      <td>106385</td>\n",
       "      <td>заняться образованием</td>\n",
       "      <td>[заниматься,  , образование, \\n]</td>\n",
       "      <td>образование</td>\n",
       "      <td>средний</td>\n",
       "      <td>один ребенок</td>\n",
       "      <td>доверительный клиент</td>\n",
       "      <td>не замужем</td>\n",
       "      <td>женщина с средним образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>46</td>\n",
       "      <td>2</td>\n",
       "      <td>2262</td>\n",
       "      <td>37</td>\n",
       "      <td>среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>женат / замужем</td>\n",
       "      <td>0</td>\n",
       "      <td>F</td>\n",
       "      <td>компаньон</td>\n",
       "      <td>0</td>\n",
       "      <td>182682</td>\n",
       "      <td>сделка с подержанным автомобилем</td>\n",
       "      <td>[сделка,  , с,  , подержанный,  , автомобиль, \\n]</td>\n",
       "      <td>автомобиль</td>\n",
       "      <td>высокий</td>\n",
       "      <td>многодетная семья</td>\n",
       "      <td>элитный клиент</td>\n",
       "      <td>замужем</td>\n",
       "      <td>женщина с средним образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>47</td>\n",
       "      <td>1</td>\n",
       "      <td>2689</td>\n",
       "      <td>33</td>\n",
       "      <td>высшее</td>\n",
       "      <td>0</td>\n",
       "      <td>гражданский брак</td>\n",
       "      <td>1</td>\n",
       "      <td>M</td>\n",
       "      <td>госслужащий</td>\n",
       "      <td>0</td>\n",
       "      <td>356277</td>\n",
       "      <td>на проведение свадьбы</td>\n",
       "      <td>[на,  , проведение,  , свадьба, \\n]</td>\n",
       "      <td>свадьба</td>\n",
       "      <td>очень высокий</td>\n",
       "      <td>один ребенок</td>\n",
       "      <td>элитный клиент</td>\n",
       "      <td>мужчина в гражданском браке</td>\n",
       "      <td>мужчина с высшим образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>48</td>\n",
       "      <td>0</td>\n",
       "      <td>3341</td>\n",
       "      <td>45</td>\n",
       "      <td>среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>женат / замужем</td>\n",
       "      <td>0</td>\n",
       "      <td>F</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>0</td>\n",
       "      <td>162065</td>\n",
       "      <td>строительство собственной недвижимости</td>\n",
       "      <td>[строительство,  , собственный,  , недвижимост...</td>\n",
       "      <td>строительство недвижимости</td>\n",
       "      <td>выше среднего</td>\n",
       "      <td>без детей</td>\n",
       "      <td>доверительный клиент</td>\n",
       "      <td>замужем</td>\n",
       "      <td>женщина с средним образованием</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>49</td>\n",
       "      <td>0</td>\n",
       "      <td>1181</td>\n",
       "      <td>54</td>\n",
       "      <td>среднее</td>\n",
       "      <td>1</td>\n",
       "      <td>женат / замужем</td>\n",
       "      <td>0</td>\n",
       "      <td>F</td>\n",
       "      <td>сотрудник</td>\n",
       "      <td>0</td>\n",
       "      <td>44591</td>\n",
       "      <td>автомобиль</td>\n",
       "      <td>[автомобиль, \\n]</td>\n",
       "      <td>автомобиль</td>\n",
       "      <td>низкий</td>\n",
       "      <td>без детей</td>\n",
       "      <td>потенциально опасный клиент</td>\n",
       "      <td>замужем</td>\n",
       "      <td>женщина с средним образованием</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    children  days_employed  dob_years            education  education_id  \\\n",
       "0          1           8437         42               высшее             0   \n",
       "1          1           4024         36              среднее             1   \n",
       "2          0           5623         33              среднее             1   \n",
       "3          3           4124         32              среднее             1   \n",
       "4          0          14177         53              среднее             1   \n",
       "5          0            926         27               высшее             0   \n",
       "6          0           2879         43               высшее             0   \n",
       "7          0            152         50              среднее             1   \n",
       "8          2           6929         35               высшее             0   \n",
       "9          0           2188         41              среднее             1   \n",
       "10         2           4171         36               высшее             0   \n",
       "11         0            792         40              среднее             1   \n",
       "12         0           4678         65              среднее             1   \n",
       "13         0           1846         54  неоконченное высшее             2   \n",
       "14         0           1844         56               высшее             0   \n",
       "15         1            972         26              среднее             1   \n",
       "16         0           1719         35              среднее             1   \n",
       "17         0           2369         33               высшее             0   \n",
       "18         0          16678         53              среднее             1   \n",
       "19         0          10038         48              среднее             1   \n",
       "20         1           1311         36              среднее             1   \n",
       "21         1            253         33              среднее             1   \n",
       "22         1           1766         24              среднее             1   \n",
       "23         0            272         21               высшее             0   \n",
       "24         1          14106         57              среднее             1   \n",
       "25         0          15147         67              среднее             1   \n",
       "26         0           4678         41              среднее             1   \n",
       "27         0            529         28               высшее             0   \n",
       "28         1            717         26               высшее             0   \n",
       "29         0           4678         63              среднее             1   \n",
       "30         1          13982         62              среднее             1   \n",
       "31         0           1682         47            начальное             3   \n",
       "32         0           4649         34              среднее             1   \n",
       "33         0           1548         48              среднее             1   \n",
       "34         0           4488         35              среднее             1   \n",
       "35         0          16417         68              среднее             1   \n",
       "36         0            176         33              среднее             1   \n",
       "37         0           6448         43               высшее             0   \n",
       "38         0            597         25               высшее             0   \n",
       "39         0            650         31               высшее             0   \n",
       "40         0           1030         30              среднее             1   \n",
       "41         0           4678         50              среднее             1   \n",
       "42         0           1257         20  неоконченное высшее             2   \n",
       "43         0           4375         43  неоконченное высшее             2   \n",
       "44         1           1362         26              среднее             1   \n",
       "45         1           1039         49              среднее             1   \n",
       "46         2           2262         37              среднее             1   \n",
       "47         1           2689         33               высшее             0   \n",
       "48         0           3341         45              среднее             1   \n",
       "49         0           1181         54              среднее             1   \n",
       "\n",
       "            family_status  family_status_id gender  income_type  debt  \\\n",
       "0         женат / замужем                 0      F    сотрудник     0   \n",
       "1         женат / замужем                 0      F    сотрудник     0   \n",
       "2         женат / замужем                 0      M    сотрудник     0   \n",
       "3         женат / замужем                 0      M    сотрудник     0   \n",
       "4        гражданский брак                 1      F    пенсионер     0   \n",
       "5        гражданский брак                 1      M    компаньон     0   \n",
       "6         женат / замужем                 0      F    компаньон     0   \n",
       "7         женат / замужем                 0      M    сотрудник     0   \n",
       "8        гражданский брак                 1      F    сотрудник     0   \n",
       "9         женат / замужем                 0      M    сотрудник     0   \n",
       "10        женат / замужем                 0      M    компаньон     0   \n",
       "11        женат / замужем                 0      F    сотрудник     0   \n",
       "12       гражданский брак                 1      M    пенсионер     0   \n",
       "13        женат / замужем                 0      F    сотрудник     0   \n",
       "14       гражданский брак                 1      F    компаньон     1   \n",
       "15        женат / замужем                 0      F    сотрудник     0   \n",
       "16        женат / замужем                 0      F    сотрудник     0   \n",
       "17       гражданский брак                 1      M    сотрудник     0   \n",
       "18         вдовец / вдова                 2      F    пенсионер     0   \n",
       "19              в разводе                 3      F    сотрудник     0   \n",
       "20        женат / замужем                 0      M    сотрудник     0   \n",
       "21       гражданский брак                 1      F    сотрудник     0   \n",
       "22       гражданский брак                 1      F    сотрудник     0   \n",
       "23       гражданский брак                 1      M    сотрудник     0   \n",
       "24  Не женат / не замужем                 4      F    пенсионер     0   \n",
       "25        женат / замужем                 0      M    пенсионер     0   \n",
       "26        женат / замужем                 0      M  госслужащий     0   \n",
       "27        женат / замужем                 0      M    сотрудник     0   \n",
       "28        женат / замужем                 0      F    сотрудник     0   \n",
       "29  Не женат / не замужем                 4      F    пенсионер     0   \n",
       "30        женат / замужем                 0      F    пенсионер     0   \n",
       "31        женат / замужем                 0      F    сотрудник     0   \n",
       "32       гражданский брак                 1      F    сотрудник     1   \n",
       "33        женат / замужем                 0      F    компаньон     0   \n",
       "34        женат / замужем                 0      F    сотрудник     0   \n",
       "35       гражданский брак                 1      M    пенсионер     0   \n",
       "36  Не женат / не замужем                 4      M    сотрудник     0   \n",
       "37       гражданский брак                 1      F    компаньон     0   \n",
       "38  Не женат / не замужем                 4      M    сотрудник     1   \n",
       "39       гражданский брак                 1      F    компаньон     0   \n",
       "40  Не женат / не замужем                 4      M    компаньон     0   \n",
       "41        женат / замужем                 0      F  госслужащий     0   \n",
       "42  Не женат / не замужем                 4      F    сотрудник     0   \n",
       "43              в разводе                 3      F    компаньон     0   \n",
       "44        женат / замужем                 0      F    сотрудник     0   \n",
       "45  Не женат / не замужем                 4      F    сотрудник     0   \n",
       "46        женат / замужем                 0      F    компаньон     0   \n",
       "47       гражданский брак                 1      M  госслужащий     0   \n",
       "48        женат / замужем                 0      F    сотрудник     0   \n",
       "49        женат / замужем                 0      F    сотрудник     0   \n",
       "\n",
       "    total_income                                 purpose  \\\n",
       "0         253875                           покупка жилья   \n",
       "1         112080                 приобретение автомобиля   \n",
       "2         145885                           покупка жилья   \n",
       "3         267628              дополнительное образование   \n",
       "4         158616                         сыграть свадьбу   \n",
       "5         255763                           покупка жилья   \n",
       "6         240525                       операции с жильем   \n",
       "7         135823                             образование   \n",
       "8          95856                   на проведение свадьбы   \n",
       "9         144425                 покупка жилья для семьи   \n",
       "10        113943                    покупка недвижимости   \n",
       "11         77069       покупка коммерческой недвижимости   \n",
       "12        153752                         сыграть свадьбу   \n",
       "13        130458                 приобретение автомобиля   \n",
       "14        165127              покупка жилой недвижимости   \n",
       "15        116820  строительство собственной недвижимости   \n",
       "16        289202                            недвижимость   \n",
       "17         90410              строительство недвижимости   \n",
       "18         56823      на покупку подержанного автомобиля   \n",
       "19        242831            на покупку своего автомобиля   \n",
       "20        209552                            недвижимость   \n",
       "21        131812                 приобретение автомобиля   \n",
       "22        149681      на покупку подержанного автомобиля   \n",
       "23        128265                         сыграть свадьбу   \n",
       "24        290547   операции с коммерческой недвижимостью   \n",
       "25         55112                    покупка недвижимости   \n",
       "26        153752                             образование   \n",
       "27        308848  строительство собственной недвижимости   \n",
       "28        187863  строительство собственной недвижимости   \n",
       "29        153752        строительство жилой недвижимости   \n",
       "30        171456   операции с коммерческой недвижимостью   \n",
       "31        275485                                   жилье   \n",
       "32        139057                   на проведение свадьбы   \n",
       "33        157245                           покупка жилья   \n",
       "34        104660         операции со своей недвижимостью   \n",
       "35         77805                   на проведение свадьбы   \n",
       "36        138830                              автомобили   \n",
       "37        154128                 приобретение автомобиля   \n",
       "38        192247                             образование   \n",
       "39        754240                   заняться образованием   \n",
       "40        142865                    покупка недвижимости   \n",
       "41        153752        сделка с подержанным автомобилем   \n",
       "42         82065                   получение образования   \n",
       "43        272957                 приобретение автомобиля   \n",
       "44        100780            на покупку своего автомобиля   \n",
       "45        106385                   заняться образованием   \n",
       "46        182682        сделка с подержанным автомобилем   \n",
       "47        356277                   на проведение свадьбы   \n",
       "48        162065  строительство собственной недвижимости   \n",
       "49         44591                              автомобиль   \n",
       "\n",
       "                                               lemmas  \\\n",
       "0                             [покупка,  , жилье, \\n]   \n",
       "1                   [приобретение,  , автомобиль, \\n]   \n",
       "2                             [покупка,  , жилье, \\n]   \n",
       "3                [дополнительный,  , образование, \\n]   \n",
       "4                           [сыграть,  , свадьба, \\n]   \n",
       "5                             [покупка,  , жилье, \\n]   \n",
       "6                      [операция,  , с,  , жилье, \\n]   \n",
       "7                                   [образование, \\n]   \n",
       "8                 [на,  , проведение,  , свадьба, \\n]   \n",
       "9           [покупка,  , жилье,  , для,  , семья, \\n]   \n",
       "10                     [покупка,  , недвижимость, \\n]   \n",
       "11    [покупка,  , коммерческий,  , недвижимость, \\n]   \n",
       "12                          [сыграть,  , свадьба, \\n]   \n",
       "13                  [приобретение,  , автомобиль, \\n]   \n",
       "14           [покупка,  , жилой,  , недвижимость, \\n]   \n",
       "15  [строительство,  , собственный,  , недвижимост...   \n",
       "16                                 [недвижимость, \\n]   \n",
       "17               [строительство,  , недвижимость, \\n]   \n",
       "18  [на,  , покупка,  , подержать,  , автомобиль, \\n]   \n",
       "19       [на,  , покупка,  , свой,  , автомобиль, \\n]   \n",
       "20                                 [недвижимость, \\n]   \n",
       "21                  [приобретение,  , автомобиль, \\n]   \n",
       "22  [на,  , покупка,  , подержать,  , автомобиль, \\n]   \n",
       "23                          [сыграть,  , свадьба, \\n]   \n",
       "24  [операция,  , с,  , коммерческий,  , недвижимо...   \n",
       "25                     [покупка,  , недвижимость, \\n]   \n",
       "26                                  [образование, \\n]   \n",
       "27  [строительство,  , собственный,  , недвижимост...   \n",
       "28  [строительство,  , собственный,  , недвижимост...   \n",
       "29     [строительство,  , жилой,  , недвижимость, \\n]   \n",
       "30  [операция,  , с,  , коммерческий,  , недвижимо...   \n",
       "31                                        [жилье, \\n]   \n",
       "32                [на,  , проведение,  , свадьба, \\n]   \n",
       "33                            [покупка,  , жилье, \\n]   \n",
       "34    [операция,  , со,  , свой,  , недвижимость, \\n]   \n",
       "35                [на,  , проведение,  , свадьба, \\n]   \n",
       "36                                   [автомобиль, \\n]   \n",
       "37                  [приобретение,  , автомобиль, \\n]   \n",
       "38                                  [образование, \\n]   \n",
       "39                   [заниматься,  , образование, \\n]   \n",
       "40                     [покупка,  , недвижимость, \\n]   \n",
       "41  [сделка,  , с,  , подержанный,  , автомобиль, \\n]   \n",
       "42                    [получение,  , образование, \\n]   \n",
       "43                  [приобретение,  , автомобиль, \\n]   \n",
       "44       [на,  , покупка,  , свой,  , автомобиль, \\n]   \n",
       "45                   [заниматься,  , образование, \\n]   \n",
       "46  [сделка,  , с,  , подержанный,  , автомобиль, \\n]   \n",
       "47                [на,  , проведение,  , свадьба, \\n]   \n",
       "48  [строительство,  , собственный,  , недвижимост...   \n",
       "49                                   [автомобиль, \\n]   \n",
       "\n",
       "                 purpose_group   income_group     children_group  \\\n",
       "0                        жилье  очень высокий       один ребенок   \n",
       "1                   автомобиль        средний       один ребенок   \n",
       "2                        жилье  выше среднего          без детей   \n",
       "3                  образование  очень высокий  многодетная семья   \n",
       "4                      свадьба  выше среднего          без детей   \n",
       "5                        жилье  очень высокий          без детей   \n",
       "6                        жилье  очень высокий          без детей   \n",
       "7                  образование  выше среднего          без детей   \n",
       "8                      свадьба         низкий  многодетная семья   \n",
       "9                        жилье  выше среднего          без детей   \n",
       "10                       жилье        средний  многодетная семья   \n",
       "11   коммерческая недвижимость         низкий          без детей   \n",
       "12                     свадьба  выше среднего          без детей   \n",
       "13                  автомобиль        средний          без детей   \n",
       "14                       жилье        высокий          без детей   \n",
       "15  строительство недвижимости        средний       один ребенок   \n",
       "16                       жилье  очень высокий          без детей   \n",
       "17  строительство недвижимости         низкий          без детей   \n",
       "18                  автомобиль         низкий          без детей   \n",
       "19                  автомобиль  очень высокий          без детей   \n",
       "20                       жилье        высокий       один ребенок   \n",
       "21                  автомобиль        средний       один ребенок   \n",
       "22                  автомобиль  выше среднего       один ребенок   \n",
       "23                     свадьба        средний          без детей   \n",
       "24   коммерческая недвижимость  очень высокий       один ребенок   \n",
       "25                       жилье         низкий          без детей   \n",
       "26                 образование  выше среднего          без детей   \n",
       "27  строительство недвижимости  очень высокий          без детей   \n",
       "28  строительство недвижимости        высокий       один ребенок   \n",
       "29  строительство недвижимости  выше среднего          без детей   \n",
       "30   коммерческая недвижимость        высокий       один ребенок   \n",
       "31                       жилье  очень высокий          без детей   \n",
       "32                     свадьба  выше среднего          без детей   \n",
       "33                       жилье  выше среднего          без детей   \n",
       "34                       жилье        средний          без детей   \n",
       "35                     свадьба         низкий          без детей   \n",
       "36                  автомобиль  выше среднего          без детей   \n",
       "37                  автомобиль  выше среднего          без детей   \n",
       "38                 образование        высокий          без детей   \n",
       "39                 образование  очень высокий          без детей   \n",
       "40                       жилье  выше среднего          без детей   \n",
       "41                  автомобиль  выше среднего          без детей   \n",
       "42                 образование         низкий          без детей   \n",
       "43                  автомобиль  очень высокий          без детей   \n",
       "44                  автомобиль        средний       один ребенок   \n",
       "45                 образование        средний       один ребенок   \n",
       "46                  автомобиль        высокий  многодетная семья   \n",
       "47                     свадьба  очень высокий       один ребенок   \n",
       "48  строительство недвижимости  выше среднего          без детей   \n",
       "49                  автомобиль         низкий          без детей   \n",
       "\n",
       "               category_clients        family_status_clients  \\\n",
       "0                элитный клиент                      замужем   \n",
       "1          доверительный клиент                      замужем   \n",
       "2          доверительный клиент                        женат   \n",
       "3                элитный клиент                        женат   \n",
       "4          доверительный клиент  женщина в гражданском браке   \n",
       "5                элитный клиент  мужчина в гражданском браке   \n",
       "6                элитный клиент                      замужем   \n",
       "7          доверительный клиент                        женат   \n",
       "8   потенциально опасный клиент  женщина в гражданском браке   \n",
       "9          доверительный клиент                        женат   \n",
       "10         доверительный клиент                        женат   \n",
       "11  потенциально опасный клиент                      замужем   \n",
       "12         доверительный клиент  мужчина в гражданском браке   \n",
       "13         доверительный клиент                      замужем   \n",
       "14            нормальный клиент  женщина в гражданском браке   \n",
       "15         доверительный клиент                      замужем   \n",
       "16               элитный клиент                      замужем   \n",
       "17  потенциально опасный клиент  мужчина в гражданском браке   \n",
       "18  потенциально опасный клиент                        вдова   \n",
       "19               элитный клиент            женщина в разводе   \n",
       "20               элитный клиент                        женат   \n",
       "21         доверительный клиент  женщина в гражданском браке   \n",
       "22         доверительный клиент  женщина в гражданском браке   \n",
       "23         доверительный клиент  мужчина в гражданском браке   \n",
       "24               элитный клиент                   не замужем   \n",
       "25  потенциально опасный клиент                        женат   \n",
       "26         доверительный клиент                        женат   \n",
       "27               элитный клиент                        женат   \n",
       "28               элитный клиент                      замужем   \n",
       "29         доверительный клиент                   не замужем   \n",
       "30               элитный клиент                      замужем   \n",
       "31               элитный клиент                      замужем   \n",
       "32            нормальный клиент  женщина в гражданском браке   \n",
       "33         доверительный клиент                      замужем   \n",
       "34         доверительный клиент                      замужем   \n",
       "35  потенциально опасный клиент  мужчина в гражданском браке   \n",
       "36         доверительный клиент                     не женат   \n",
       "37         доверительный клиент  женщина в гражданском браке   \n",
       "38            нормальный клиент                     не женат   \n",
       "39               элитный клиент  женщина в гражданском браке   \n",
       "40         доверительный клиент                     не женат   \n",
       "41         доверительный клиент                      замужем   \n",
       "42  потенциально опасный клиент                   не замужем   \n",
       "43               элитный клиент            женщина в разводе   \n",
       "44         доверительный клиент                      замужем   \n",
       "45         доверительный клиент                   не замужем   \n",
       "46               элитный клиент                      замужем   \n",
       "47               элитный клиент  мужчина в гражданском браке   \n",
       "48         доверительный клиент                      замужем   \n",
       "49  потенциально опасный клиент                      замужем   \n",
       "\n",
       "            education_status_clients  \n",
       "0      женщина с высшим образованием  \n",
       "1     женщина с средним образованием  \n",
       "2     мужчина с средним образованием  \n",
       "3     мужчина с средним образованием  \n",
       "4     женщина с средним образованием  \n",
       "5      мужчина с высшим образованием  \n",
       "6      женщина с высшим образованием  \n",
       "7     мужчина с средним образованием  \n",
       "8      женщина с высшим образованием  \n",
       "9     мужчина с средним образованием  \n",
       "10     мужчина с высшим образованием  \n",
       "11    женщина с средним образованием  \n",
       "12    мужчина с средним образованием  \n",
       "13                              None  \n",
       "14     женщина с высшим образованием  \n",
       "15    женщина с средним образованием  \n",
       "16    женщина с средним образованием  \n",
       "17     мужчина с высшим образованием  \n",
       "18    женщина с средним образованием  \n",
       "19    женщина с средним образованием  \n",
       "20    мужчина с средним образованием  \n",
       "21    женщина с средним образованием  \n",
       "22    женщина с средним образованием  \n",
       "23     мужчина с высшим образованием  \n",
       "24    женщина с средним образованием  \n",
       "25    мужчина с средним образованием  \n",
       "26    мужчина с средним образованием  \n",
       "27     мужчина с высшим образованием  \n",
       "28     женщина с высшим образованием  \n",
       "29    женщина с средним образованием  \n",
       "30    женщина с средним образованием  \n",
       "31  женщина с начальным образованием  \n",
       "32    женщина с средним образованием  \n",
       "33    женщина с средним образованием  \n",
       "34    женщина с средним образованием  \n",
       "35    мужчина с средним образованием  \n",
       "36    мужчина с средним образованием  \n",
       "37     женщина с высшим образованием  \n",
       "38     мужчина с высшим образованием  \n",
       "39     женщина с высшим образованием  \n",
       "40    мужчина с средним образованием  \n",
       "41    женщина с средним образованием  \n",
       "42                              None  \n",
       "43                              None  \n",
       "44    женщина с средним образованием  \n",
       "45    женщина с средним образованием  \n",
       "46    женщина с средним образованием  \n",
       "47     мужчина с высшим образованием  \n",
       "48    женщина с средним образованием  \n",
       "49    женщина с средним образованием  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "display(clients.head(50))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Вывод"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Категоризация составлялась на основе поставленных ниже вопросах. Нас интересовала зависимость:\n",
    " - наличия детей\n",
    " - семейного положения\n",
    " - уровня дохода\n",
    " - цели кредита\n",
    "\n",
    "Для семейного положения и целей кредита можно было использовать существующие данные. Чтобы дать ответ насчет детей и уровня дохода, необходимо провести категоризацию этих данных.\n",
    "Для ответа об надежности заемщика была сформирована соответсвующая категория со столбцом category_clients.\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Шаг 3. Ответьте на вопросы<a id=\"step3\"></a>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "- Есть ли зависимость между наличием детей и возвратом кредита в срок?"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "children_group     debt\n",
      "без детей          0       0.924547\n",
      "                   1       0.075453\n",
      "многодетная семья  0       0.906501\n",
      "                   1       0.093499\n",
      "один ребенок       0       0.908659\n",
      "                   1       0.091341\n",
      "Name: debt, dtype: float64\n"
     ]
    }
   ],
   "source": [
    "print(clients.groupby('children_group')['debt'].value_counts(normalize=True))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Вывод"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Если у заемщика отсутствуют дети, то вероятность возврата кредита в срок выше."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "- Есть ли зависимость между семейным положением и возвратом кредита в срок?"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "family_status          debt\n",
      "Не женат / не замужем  0       0.902291\n",
      "                       1       0.097709\n",
      "в разводе              0       0.928270\n",
      "                       1       0.071730\n",
      "вдовец / вдова         0       0.935010\n",
      "                       1       0.064990\n",
      "гражданский брак       0       0.906538\n",
      "                       1       0.093462\n",
      "женат / замужем        0       0.924573\n",
      "                       1       0.075427\n",
      "Name: debt, dtype: float64\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th>debt</th>\n",
       "      <th>0</th>\n",
       "      <th>1</th>\n",
       "      <th>ratio</th>\n",
       "      <th>ratio_debt</th>\n",
       "      <th>ratio_no_debt</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>family_status</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>Не женат / не замужем</td>\n",
       "      <td>2521</td>\n",
       "      <td>273</td>\n",
       "      <td>10.829036</td>\n",
       "      <td>9.770938</td>\n",
       "      <td>90.229062</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>в разводе</td>\n",
       "      <td>1100</td>\n",
       "      <td>85</td>\n",
       "      <td>7.727273</td>\n",
       "      <td>7.172996</td>\n",
       "      <td>92.827004</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>вдовец / вдова</td>\n",
       "      <td>892</td>\n",
       "      <td>62</td>\n",
       "      <td>6.950673</td>\n",
       "      <td>6.498952</td>\n",
       "      <td>93.501048</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>гражданский брак</td>\n",
       "      <td>3744</td>\n",
       "      <td>386</td>\n",
       "      <td>10.309829</td>\n",
       "      <td>9.346247</td>\n",
       "      <td>90.653753</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>женат / замужем</td>\n",
       "      <td>11363</td>\n",
       "      <td>927</td>\n",
       "      <td>8.158057</td>\n",
       "      <td>7.542718</td>\n",
       "      <td>92.457282</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "debt                       0    1      ratio  ratio_debt  ratio_no_debt\n",
       "family_status                                                          \n",
       "Не женат / не замужем   2521  273  10.829036    9.770938      90.229062\n",
       "в разводе               1100   85   7.727273    7.172996      92.827004\n",
       "вдовец / вдова           892   62   6.950673    6.498952      93.501048\n",
       "гражданский брак        3744  386  10.309829    9.346247      90.653753\n",
       "женат / замужем        11363  927   8.158057    7.542718      92.457282"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "print(clients.groupby('family_status')['debt'].value_counts(normalize=True))\n",
    "\n",
    "family_status_pivot = clients.pivot_table(index=['family_status'], columns=['debt'], values='total_income', aggfunc='count')\n",
    "family_status_pivot['ratio'] = family_status_pivot[1] / family_status_pivot[0] * 100\n",
    "family_status_pivot['ratio_debt'] = family_status_pivot[1] / (family_status_pivot[0] + family_status_pivot[1])  * 100\n",
    "family_status_pivot['ratio_no_debt'] = family_status_pivot[0] / (family_status_pivot[0] + family_status_pivot[1])  * 100\n",
    "\n",
    "display(family_status_pivot)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Вывод"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Если заемщик не женат, либо находится в гражданском браке, то вероятность НЕ возврата кредита в срок немного выше. Люди, которые состояли в браке, с большей вероятностью отдадут кредит в срок.\n",
    "Таким образом стоит брать во внимание данный параметр у заемщика.\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "- Есть ли зависимость между уровнем дохода и возвратом кредита в срок?"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "income_group   debt\n",
      "высокий        0       3920\n",
      "               1        350\n",
      "выше среднего  0       3885\n",
      "               1        387\n",
      "низкий         0       3928\n",
      "               1        343\n",
      "очень высокий  0       3972\n",
      "               1        299\n",
      "средний        0       3915\n",
      "               1        354\n",
      "Name: debt, dtype: int64\n",
      "income_group   debt\n",
      "высокий        0       0.918033\n",
      "               1       0.081967\n",
      "выше среднего  0       0.909410\n",
      "               1       0.090590\n",
      "низкий         0       0.919691\n",
      "               1       0.080309\n",
      "очень высокий  0       0.929993\n",
      "               1       0.070007\n",
      "средний        0       0.917077\n",
      "               1       0.082923\n",
      "Name: debt, dtype: float64\n"
     ]
    }
   ],
   "source": [
    "print(clients.groupby('income_group')['debt'].value_counts())\n",
    "print(clients.groupby('income_group')['debt'].value_counts(normalize=True))\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Вывод"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Процент невозврата кредита в срок с уровнем дохода \"очень высокий\" ниже, чем у других категорий клиента. Стоит отметить интересный факт, что процент невозврата кредита у людей с доходом выше среднего, выше, чем у людей с уровнем дохода средней и низкий.\n",
    "Таким образом уровень дохода пользователей не влияет на возврат кредита в срок. Стоит оперировать другими факторами при оценке надежности заемщика."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "- Как разные цели кредита влияют на его возврат в срок?"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "purpose_group               debt\n",
      "автомобиль                  0       0.906629\n",
      "                            1       0.093371\n",
      "жилье                       0       0.929079\n",
      "                            1       0.070921\n",
      "коммерческая недвижимость   0       0.922762\n",
      "                            1       0.077238\n",
      "образование                 0       0.907384\n",
      "                            1       0.092616\n",
      "свадьба                     0       0.920346\n",
      "                            1       0.079654\n",
      "строительство недвижимости  0       0.923118\n",
      "                            1       0.076882\n",
      "улучшение жилья             0       0.942149\n",
      "                            1       0.057851\n",
      "Name: debt, dtype: float64\n"
     ]
    }
   ],
   "source": [
    "print(clients.groupby('purpose_group')['debt'].value_counts(normalize=True))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Вывод"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Люди, которые берут кредит на авто или образование, чаще других не возвращают кредит в срок. Вероятность не возврата кредита в срок очень мала для людей, которые берут кредит на ремонт. "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Шаг 4. Общий вывод"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "От заказчика был получен датасет с платёжеспособностью клиентов. \n",
    "Моей задаче стояло ответить на вопрос \"Влияет ли семейное положение и количество детей клиента на факт погашения кредита в срок\".\n",
    "На пути к решению задачи я столкнулся с проблемами в наборе данных: пустые значения, значения с ошибками, дубликаты и прочее.\n",
    "Датасет был приведен к корректному виду, удобному для дальнейшего анализа.\n",
    "После этого была дополнительно проведена категоризация по следующим параметрам:\n",
    " - по уровню дохода\n",
    " - по наличию детей\n",
    " - по ежемесячном доходу и возврате кредита в срок\n",
    "\n",
    "Данная информация позволит заказчику ответить на дополнительные вопросы, и структурировать пользоватей по степени надежности.\n",
    "\n",
    "Ответ на вопрос в задаче: влияет ли семейное положение и количество детей клиента на факт погашения кредита в срок - да, влияет. Если у заемщика есть дети, то вероятность задержки возврата кредита выше. Данное утверждение также подходит и для людей, которые не были в браке.\n",
    "Таким образом, при выдаче кредитов стоит обращать внимание на наличие детей у клиента и его семейное положение."
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
